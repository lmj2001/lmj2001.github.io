<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>愿你生命的每一天都充满美好</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="个人博客">
<meta property="og:type" content="website">
<meta property="og:title" content="愿你生命的每一天都充满美好">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="愿你生命的每一天都充满美好">
<meta property="og:description" content="个人博客">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="MainJay">
<meta property="article:tag" content="美好">
<meta name="twitter:card" content="summary">
  
    <link rel="alternate" href="/atom.xml" title="愿你生命的每一天都充满美好" type="application/atom+xml">
  
  
    <link rel="icon" href="/picture.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 5.4.0"></head>

<a target="_blank" rel="noopener" href="https://github.com/zhchnchn"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/82b228a3648bf44fc1163ef44c62fcc60081495e/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f7265645f6161303030302e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_red_aa0000.png"></a>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">愿你生命的每一天都充满美好</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-hdfs" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/31/hdfs/" class="article-date">
  <time datetime="2021-07-31T06:47:55.000Z" itemprop="datePublished">2021-07-31</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/31/hdfs/">hdfs</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Java-amp-Python-HDFS"><a href="#Java-amp-Python-HDFS" class="headerlink" title="Java &amp; Python HDFS"></a>Java &amp; Python HDFS</h2><h3 id="讨论"><a href="#讨论" class="headerlink" title="讨论"></a>讨论</h3><h4 id="运行位置"><a href="#运行位置" class="headerlink" title="运行位置"></a>运行位置</h4><p>Local: </p>
<ul>
<li><p>Linux : Hadoop &amp; IDEA </p>
</li>
<li><p>Linux Server : CLI Hadoop   </p>
</li>
<li><p>Remote: WebUI —— <a target="_blank" rel="noopener" href="http://master:9870/">http://master:9870</a>.   hdfs://master:9000/hdfspath</p>
</li>
<li><p>OS: Windows + IDEA </p>
</li>
</ul>
<p>jar:</p>
<ul>
<li><p>local: hadoop jar xx.jar</p>
</li>
<li><p>remote: java jar xx.jar </p>
</li>
<li><p>IDEA(remote, run|debug</p>
</li>
</ul>
<p>IDE : IDEA </p>
<h2 id="remote-idea-开发-amp-运行"><a href="#remote-idea-开发-amp-运行" class="headerlink" title="remote idea 开发&amp;运行"></a>remote idea 开发&amp;运行</h2><ul>
<li><p>byURL : 下载 hdfs 上资源</p>
</li>
<li><p>借助 HDFS API 实现 资源操作</p>
</li>
<li><p>指明操作用户,设置 client os 的系统环境变量</p>
</li>
<li><p>在代码中设置 hdfs 操作用户 HADOOP_USER_NAME<br>  获取 hdfs 的句柄<br>   <a target="_blank" rel="noopener" href="https://wiki.apache.org/hadoop/WindowsProblems">https://wiki.apache.org/hadoop/WindowsProblems</a><br>   <a target="_blank" rel="noopener" href="https://cwiki.apache.org/confluence/display/HADOOP2/WindowsProblems">https://cwiki.apache.org/confluence/display/HADOOP2/WindowsProblems</a><br>   <a target="_blank" rel="noopener" href="https://github.com/steveloughran/winutils">https://github.com/steveloughran/winutils</a><br>  解压,对应版本,放置在 c:/dev/hadoop</p>
</li>
<li><p>MR(Java) =&gt; Hadoop run<br><a target="_blank" rel="noopener" href="http://hadoop.apache.org/docs/r1.0.4/cn/mapred_tutorial.html">http://hadoop.apache.org/docs/r1.0.4/cn/mapred_tutorial.html</a></p>
</li>
</ul>
<h3 id="准备数据"><a href="#准备数据" class="headerlink" title="准备数据"></a>准备数据</h3><ul>
<li><p>upload hdfs  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hdfs dfs -mkdir -p /input/mr/wc01</span><br><span class="line">hdfs dfs -put /share/mr/data/* /input/mr/wc01</span><br><span class="line">mr -- java </span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="编写程序"><a href="#编写程序" class="headerlink" title="编写程序"></a>编写程序</h3><ol>
<li><p>new maven project<br> 添加依赖 == hadoop-client</p>
</li>
<li><p>override map</p>
 <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WCGenderMapper</span> <span class="keyword">extends</span> <span class="title">Mapper</span>&lt;<span class="title">LongWritable</span>, <span class="title">Text</span>, <span class="title">Text</span>, <span class="title">IntWritable</span>&gt;</span></span><br><span class="line"><span class="class">//<span class="keyword">extends</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">hadoop</span>.<span class="title">mapreduce</span>.<span class="title">Mapper</span></span></span><br></pre></td></tr></table></figure>

<p> &lt;LongWritable, Text, Text, IntWritable&gt;分别对应 mapper 输入的 key,value 和 mapper 输出的 key,value </p>
<p> 在 Hadoop 中的可序列化的数据类型 </p>
</li>
<li><p>override reduce</p>
<pre><code> 获取每一行, 拆分, 生成 mapper 输出的 midMap&lt;行中每个单词, 1&gt;
</code></pre>
   <figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">WCGenderReducer</span> <span class="keyword">extends</span> <span class="title">Reducer</span>&lt;<span class="title">Text</span>, <span class="title">IntWritable</span>, <span class="title">Text</span>, <span class="title">LongWritable</span>&gt;  </span></span><br><span class="line"><span class="class">//<span class="title">exitends</span> <span class="title">org</span>.<span class="title">apache</span>.<span class="title">hadoop</span>.<span class="title">mapreduce</span>.<span class="title">Reduce</span></span></span><br></pre></td></tr></table></figure>

<p>   &lt;Text, IntWritable, Text, LongWritable&gt; 分别对应 mapper 的输出的 key,value 和 最终的输出结果的 key,value </p>
<p>   在 Hadoop 中的可序列化的数据类型 </p>
</li>
<li><p>遍历输出<br>  遍历 values, 统计, 写入最终 destMap&lt;每个单词, 单词出现次数&gt; 中<br>  maven-&gt;项目名称-&gt;lifecycle-&gt;package</p>
</li>
<li><p>上传 jar, 在 hadoop 运行 jar </p>
  <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar mymr.jar /input/mr/wc01 /output/wc01</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="MapReduce"><a href="#MapReduce" class="headerlink" title="MapReduce"></a>MapReduce</h2><h3 id="运行方式"><a href="#运行方式" class="headerlink" title="运行方式"></a>运行方式</h3><h4 id="jar"><a href="#jar" class="headerlink" title="jar"></a>jar</h4><p>​      upload </p>
<p>​       remote hadoop cluster package</p>
<h4 id="IDEA-本地执行"><a href="#IDEA-本地执行" class="headerlink" title="IDEA 本地执行"></a>IDEA 本地执行</h4><ol>
<li>input/output src</li>
<li>在当前项目中,修改Hadoop源代码NativeIO</li>
</ol>
<p>​      建议:运行前重启,或者重新修改pom文件并且刷新</p>
<ol start="3">
<li>设置本地运行的启动参数</li>
<li>修改</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/31/hdfs/" data-id="ckscnkdpl0002sy5b6lur1cvz" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/hdfs/" rel="tag">hdfs</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Hadoop" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/29/Hadoop/" class="article-date">
  <time datetime="2021-07-29T02:14:10.000Z" itemprop="datePublished">2021-07-29</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/29/Hadoop/">Hadoop</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h2><ol>
<li><p> 多个存储单元和存储器</p>
</li>
<li><p>有效地存储和处理大数据</p>
</li>
<li><p>存储数据</p>
<ul>
<li>HDFS对数据进行拷贝并将其存储在多个系统中</li>
<li>当一个节点被创建时,会将其存储在不同的数据节点上</li>
</ul>
</li>
<li><p>处理数据MapReduce</p>
</li>
<li><p>组成:资源管理器、节点管理器、应用管理器和容器组成</p>
</li>
</ol>
<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><h3 id="提供预安装"><a href="#提供预安装" class="headerlink" title="提供预安装"></a>提供预安装</h3><p>Vagrantfile 个性化</p>
<ul>
<li>所有节点数组中每一个机器节点描述的 ip &amp; bridge</li>
<li> jdk 安装文件的位置（好几个。。。）</li>
</ul>
<h3 id="过程有错"><a href="#过程有错" class="headerlink" title="过程有错:"></a>过程有错:</h3><ol>
<li><p>宿主机的资源不够</p>
</li>
<li><p>找到一个可用的授时服务器 (?)</p>
<h2 id="Hadoop-全分布集群安装"><a href="#Hadoop-全分布集群安装" class="headerlink" title="Hadoop 全分布集群安装"></a>Hadoop 全分布集群安装</h2></li>
<li><p>预配置、准备工作</p>
</li>
<li><p> 确认运行模式 - 全分布集群模式</p>
</li>
<li><p>确定运行用户 - vagrant</p>
</li>
<li><p>网络配置 - IPAddress</p>
</li>
<li><p>主机名配置 - hostname &amp; hosts</p>
</li>
<li><p>支撑软件 - jdk -&gt; usr/java + .profile &lt; source &gt;</p>
</li>
<li><p>ssh 免密登录</p>
</li>
<li><p>关闭防火墙 – debian没有预置 firewall</p>
</li>
</ol>
<h3 id="软件下载"><a href="#软件下载" class="headerlink" title="软件下载"></a>软件下载</h3><ol>
<li>ssh 免密 </li>
</ol>
<ul>
<li>使用 vagrant 用户在每台机机器逐一执行 <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ssh localhost </span><br><span class="line">ssh master</span><br><span class="line">sh slave01</span><br><span class="line">ssh slave02</span><br></pre></td></tr></table></figure>
进入对应机器, 使用 exit 命令退出<br>注释、删除所有节点 /etc/hosts 中 <code>127.0.0.1  master master.hadoop </code></li>
<li>可能需要删除 slave01 &amp; slave02 节点上.ssh/know_hosts 文件</li>
<li> 在每台机机器, 生产ssh 密钥,并将公钥追加到其他机器上<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> master</span> </span><br><span class="line">ssh-keygen -t rsa </span><br><span class="line">scp /home/vagrant/.ssh/id_rsa.pub vagrant@slave01:~/</span><br><span class="line">scp /home/vagrant/.ssh/id_rsa.pub vagrant@slave02:~/</span><br><span class="line">cat .ssh/id_rsa.pub &gt;&gt; .ssh/authorized_keys</span><br><span class="line"><span class="meta"></span></span><br><span class="line"><span class="meta">#</span><span class="bash"> slave01 将传过来的 master|vagrant 的公钥追加到 ~/.ssh/authorized_keys</span></span><br><span class="line">cd </span><br><span class="line">cat id_rsa.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line"><span class="meta">#</span><span class="bash"> 删传过来的公钥</span> </span><br><span class="line">cd </span><br><span class="line">rm id_rsa.pub</span><br><span class="line"><span class="meta">#</span><span class="bash"> 确认权限</span> </span><br><span class="line">authorized_keys</span><br><span class="line">ls -l .ssh/authorized_keys</span><br><span class="line"><span class="meta">#</span><span class="bash"> 验证:</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> master:</span></span><br><span class="line">ssh slave01 </span><br><span class="line">slave02 </span><br></pre></td></tr></table></figure></li>
<li>cluster install <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> master 上 vagrant 用户完成</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 下载 / 上传 / 解压</span> </span><br><span class="line">cd</span><br><span class="line">cp /share/hadoop/software/hadoop-3.2.2.tar.gz.  .</span><br><span class="line">tar -xzvf hadoop-3.2.2.tar.gz</span><br><span class="line">mv hadoop-3.2.2 hadoop3      </span><br><span class="line">rm hadoop-3.2.2.tar.gz</span><br></pre></td></tr></table></figure></li>
<li>配置系统 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># for Java</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_291</span><br><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$JAVA_HOME</span>/bin:<span class="variable">$PATH</span></span><br><span class="line"><span class="comment"># for hadoop</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_HOME=/home/vagrant/hadoop3</span><br><span class="line"><span class="built_in">export</span> YARN_HOME=<span class="variable">$HOME</span>/hadoop3</span><br><span class="line"><span class="built_in">export</span> HADOOP_CONF_DIR=<span class="variable">$HADOOP_HOME</span>/etc/hadoop</span><br><span class="line"><span class="built_in">export</span> HDFS_CONF_DIR=<span class="variable">$HADOOP_HOME</span>/etc/hadoop</span><br><span class="line"><span class="comment"># YARN_CONF_DIR 是降级的环境变量, 应该用 HADOOP_CONF_DIR 替换</span></span><br><span class="line"><span class="comment"># export YARN_CONF_DIR=$YARN_HOME/etc/hadoop</span></span><br><span class="line"><span class="built_in">export</span> HADOOP_COMMON_LIB_NATIVE_DIR=<span class="variable">$HADOOP_HOME</span>/lib/native</span><br><span class="line"><span class="built_in">export</span> HADOOP_OPTS=<span class="string">&quot;-Djava.library.path=<span class="variable">$HADOOP_HOME</span>/lib/native:<span class="variable">$HADOOP_COMMON_LIB_NATIVE_DIR</span>&quot;</span></span><br><span class="line"><span class="built_in">export</span> PATH=.:<span class="variable">$JAVA_HOME</span>/lib:<span class="variable">$HADOOP_HOME</span>/bin:<span class="variable">$HADOOP_HOME</span>/sbin:<span class="variable">$PATH</span></span><br></pre></td></tr></table></figure></li>
<li>配自身</li>
</ul>
<ol>
<li><p>hadoop-env.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置 JAVA_HOME 环境变量, 可以使用 Linux 的 ~/.bash_profile 设置的环境变量, 推荐使用此处配置</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_291</span><br></pre></td></tr></table></figure></li>
<li><p>yarn-env.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置 JAVA_HOME 环境变量, 可以使用 Linux 的 ~/.bash_profile 设置的环境变量, 推荐使用此处配置</span></span><br><span class="line"><span class="built_in">export</span> JAVA_HOME=/usr/java/jdk1.8.0_291</span><br></pre></td></tr></table></figure></li>
<li><p>全部配置: core-site.xml 加入: </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>fs.defaultFS<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>hdfs://master:9000<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>hadoop.tmp.dir<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/vagrant/hadoopdata<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
<li><p>hdfs-site.xml 加入: </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.replication<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>2<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="comment">&lt;!-- 取消“访问控制检查”, 保证WebUI模式可以进行文件上传 --&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">name</span>&gt;</span>dfs.permissions<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">value</span>&gt;</span>false<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span> </span><br></pre></td></tr></table></figure></li>
<li><p>mapred-site.xml 加入: </p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.framework.name<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>yarn<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10020<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19888<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.webapp.https.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:19890<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.jobhistory.admin.address<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">value</span>&gt;</span>master:10033<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">property</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">property</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">name</span>&gt;</span>mapreduce.application.classpath<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">value</span>&gt;</span>/home/vagrant/hadoop3/etc/hadoop:/home/vagrant/hadoop3/share/hadoop/common/lib/*:/home/vagrant/hadoop3/share/hadoop/common/*:/home/vagrant/hadoop3/share/hadoop/hdfs:/home/vagrant/hadoop3/share/hadoop/hdfs/lib/*:/home/vagrant/hadoop3/share/hadoop/hdfs/*:/home/vagrant/hadoop3/share/hadoop/mapreduce/lib/*:/home/vagrant/hadoop3/share/hadoop/mapreduce/*:/home/vagrant/hadoop3/share/hadoop/yarn:/home/vagrant/hadoop3/share/hadoop/yarn/lib/*:/home/vagrant/hadoop3/share/hadoop/yarn/*<span class="tag">&lt;/<span class="name">value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">property</span>&gt;</span>`</span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li>将上述的所有文件(安装\配置) 复制到 slave01 | slave02 对应目录<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">``<span class="built_in">cd</span> </span><br><span class="line">``scp .profile vagrant@slave01:~/</span><br><span class="line">``scp .profile vagrant@slave02:~/</span><br><span class="line">  <span class="comment">#``建议 立刻 source 一下 </span></span><br><span class="line">``scp -r hadoop3/ vagrant@slave01:~/</span><br><span class="line">``scp -r hadoop3/ vagrant@slave02:~/</span><br></pre></td></tr></table></figure>
<h3 id="cluster-start"><a href="#cluster-start" class="headerlink" title="cluster start"></a>cluster start</h3></li>
</ul>
<p>1.前提:<br>source 每台机器的 vagrant 主目录下的 .profile<br>在每台机机器的 vagrant 主目录下 创建 hadoopdata<br>2.启动 </p>
<ul>
<li>格式化 hdfs == master 上<br> <code>hdfs namenode -format </code></li>
<li>启动 <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#``0 - start-all.sh 不推荐 </span></span><br><span class="line"><span class="comment"># ``1. 分别启动 </span></span><br><span class="line">``start-dfs.sh</span><br><span class="line">``start-yarn.sh </span><br><span class="line"><span class="comment">#``验证:</span></span><br><span class="line">``jps </span><br><span class="line"><span class="comment"># ``master : Namenode\SecondaryNamenode\ResourceManager </span></span><br><span class="line"><span class="comment"># ``slave01&amp;slave02: Datanode\NodeManager</span></span><br></pre></td></tr></table></figure></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://hadoop.apache.org/docs/r1.0.4/cn/">学习链接</a></p>
<h2 id="Hadoop常用命令"><a href="#Hadoop常用命令" class="headerlink" title="Hadoop常用命令"></a>Hadoop常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br></pre></td><td class="code"><pre><span class="line">1. 命令分类</span><br><span class="line">    第一部分：运维命令</span><br><span class="line">        start-dfs.sh   启动namenode，datanode，启动文件系统</span><br><span class="line">        stop-dfs.sh   关闭文件系统</span><br><span class="line">        start-yarn.sh  启动resourcemanager,nodemanager</span><br><span class="line">        stop-yarn.sh  关闭resourcemanager,nodemanager</span><br><span class="line">        start-all.sh    启动hdfs，yarn</span><br><span class="line">        stop-all.sh    关闭hdfs，yarn</span><br><span class="line">        hdfs-daemon.sh start datanode  单独启动datanode</span><br><span class="line">        start-balancer.sh -t 10% 启动负载均衡，尽量不要在namenode节点使用</span><br><span class="line">        hdfs namenode -format  格式化文件系统</span><br><span class="line">        hdfs namenode -upgrade  分发新的hdfs版本之后，namenode应以upgrade选项启动</span><br><span class="line">        hdfs namenode -rollback  将namenode回滚到前一版本，这个选项要在停止集群，分发老的hdfs版本之后执行</span><br><span class="line">        hdfs namenode -finalize  finalize会删除文件系统的前一状态。最近的升级会被持久化，rollback选项将再不可用，升级终结操作之后，它会停掉namenode，分发老的hdfs版本后使用</span><br><span class="line">        hdfs namenode -importCheckpoint 从检查点目录装载镜像并保存到当前检查点目录，检查点目录由fs.checkpoint.dir指定</span><br><span class="line"></span><br><span class="line">    第二部分：hdfs文件系统命令</span><br><span class="line">        第一类：文件路径增删改查系列：</span><br><span class="line">            hdfs dfs -mkdir dir  创建文件夹</span><br><span class="line">            hdfs dfs -rmr dir  删除文件夹</span><br><span class="line">                hdfs dfs -rm -r 删除文件夹</span><br><span class="line">            hdfs dfs -ls  查看目录文件信息</span><br><span class="line">            hdfs dfs -lsr  递归查看文件目录信息</span><br><span class="line">                hdfs dfs -ls -R 递归查看文件目录</span><br><span class="line">            hdfs dfs -<span class="built_in">stat</span> path 返回指定路径的信息</span><br><span class="line">        第二类：空间大小查看系列命令：</span><br><span class="line">            hdfs dfs -du -h dir 按照适合阅读的形式人性化显示文件大小</span><br><span class="line">            hdfs dfs -dus uri  递归显示目标文件的大小</span><br><span class="line">            hdfs dfs -du path/file显示目标文件file的大小</span><br><span class="line"><span class="comment"># 第三类:权限管理类：</span></span><br><span class="line">            hdfs dfs -chgrp  group path  改变文件所属组</span><br><span class="line">            hdfs dfs -chgrp -R /dir  递归更改dir目录的所属组</span><br><span class="line">            hdfs dfs -chmod [-R] 权限 -path  改变文件的权限</span><br><span class="line">            hdfs dfs -chown owner[-group] /dir 改变文件的所有者</span><br><span class="line">            hdfs dfs -chown -R  owner[-group] /dir  递归更改dir目录的所属用户</span><br><span class="line">        第四类：文件操作（上传下载复制）系列：</span><br><span class="line">            hdfs dfs -touchz a.txt 创建长度为0的空文件a.txt</span><br><span class="line">            hdfs dfs -rm file   删除文件file</span><br><span class="line">            hdfs dfs -put file dir  向dir文件上传file文件</span><br><span class="line">            hdfs dfs -put filea dir/fileb 向dir上传文件filea并且把filea改名为fileb</span><br><span class="line">            hdfs dfs -get file dir  下载file到本地文件夹</span><br><span class="line">            hdfs dfs -getmerge hdfs://Master:9000/data/SogouResult.txt CombinedResult  把hdfs里面的多个文件合并成一个文件，合并后文件位于本地系统</span><br><span class="line">            hdfs dfs -cat file   查看文件file</span><br><span class="line">            hdfs fs -text /dir/a.txt  如果文件是文本格式，相当于cat，如果文件是压缩格式，则会先解压，再查看</span><br><span class="line">            hdfs fs -tail /dir/a.txt查看dir目录下面a.txt文件的最后1000字节</span><br><span class="line">            hdfs dfs -copyFromLocal localsrc path 从本地复制文件</span><br><span class="line">            hdfs dfs -copyToLocal /hdfs/a.txt /<span class="built_in">local</span>/a.txt  从hdfs拷贝到本地</span><br><span class="line">            hdfs dfs -copyFromLocal /dir/<span class="built_in">source</span> /dir/target  把文件从原路径拷贝到目标路径</span><br><span class="line">            hdfs dfs -mv /path/a.txt /path/b.txt 把文件从a目录移动到b目录，可用于回收站恢复文件</span><br><span class="line">        第五类：判断系列：</span><br><span class="line">            hdfs fs -<span class="built_in">test</span> -e /dir/a.txt 判断文件是否存在，正0负1</span><br><span class="line">            hdfs fs -<span class="built_in">test</span> -d /dir  判断dir是否为目录，正0负1</span><br><span class="line">            hdfs fs -<span class="built_in">test</span> -z /dir/a.txt  判断文件是否为空，正0负1</span><br><span class="line">        第六类：系统功能管理类：</span><br><span class="line">            hdfs dfs -expunge 清空回收站</span><br><span class="line">            hdfs dfsadmin -safemode enter 进入安全模式</span><br><span class="line">            hdfs dfsadmin -sfaemode leave 离开安全模式</span><br><span class="line">            hdfs dfsadmin -decommission datanodename 关闭某个datanode节点</span><br><span class="line">            hdfs dfsadmin -finalizeUpgrade 终结升级操作</span><br><span class="line">            hdfs dfsadmin -upgradeProcess status 查看升级操作状态</span><br><span class="line">            hdfs version 查看hdfs版本</span><br><span class="line">            hdfs daemonlog -getlevel &lt;host:port&gt; &lt;name&gt;  打印运行在&lt;host:port&gt;的守护进程的日志级别</span><br><span class="line">            hdfs daemonlog -setlevel &lt;host:port&gt; &lt;name&gt; &lt;level&gt;  设置运行在&lt;host:port&gt;的守护进程的日志级别</span><br><span class="line">            hdfs dfs -setrep -w 副本数 -R path 设置文件的副本数</span><br><span class="line"></span><br><span class="line">    第三部分：hdfs系统检查工具fsck</span><br><span class="line">        hdfs fsck &lt;path&gt; -move    移动受损文件到/lost+found</span><br><span class="line">        hdfs fsck &lt;path&gt; -delete   删除受损文件。</span><br><span class="line">        hdfs fsck &lt;path&gt; -openforwrite   打印出写打开的文件。</span><br><span class="line">        hdfs fsck &lt;path&gt; -files     打印出正被检查的文件。</span><br><span class="line">        hdfs fsck &lt;path&gt; -blocks     打印出块信息报告。</span><br><span class="line">        hdfs fsck &lt;path&gt; -locations     打印出每个块的位置信息。</span><br><span class="line">        hdfs fsck &lt;path&gt; -racks    打印出data-node的网络拓扑结构。</span><br><span class="line"></span><br><span class="line">    第四部分：mapreduce命令</span><br><span class="line">        hdfs jar file.jar 执行jar包程序</span><br><span class="line">        hdfs job -<span class="built_in">kill</span> job_201005310937_0053  杀死正在执行的jar包程序</span><br><span class="line">        hdfs job -submit &lt;job-file&gt;  提交作业</span><br><span class="line">        hdfs job -status &lt;job-id&gt;   打印map和reduce完成百分比和所有计数器。</span><br><span class="line">        hdfs job -counter &lt;job-id&gt; &lt;group-name&gt; &lt;counter-name&gt;  打印计数器的值。</span><br><span class="line">        hdfs job -<span class="built_in">kill</span> &lt;job-id&gt;  杀死指定作业。</span><br><span class="line">        hdfs job -events &lt;job-id&gt; &lt;from-event-<span class="comment">#&gt; &lt;#-of-events&gt; 打印给定范围内jobtracker接收到的事件细节。</span></span><br><span class="line">        hdfs job -<span class="built_in">history</span> [all] &lt;jobOutputDir&gt;     </span><br><span class="line">        hdfs job -<span class="built_in">history</span> &lt;jobOutputDir&gt; 打印作业的细节、失败及被杀死原因的细节。更多的关于一个作业的细节比如成功的任务，做过的任务尝试等信息可以通过指定[all]选项查看。</span><br><span class="line">        hdfs job -list [all]  显示所有作业。-list只显示将要完成的作业。</span><br><span class="line">        hdfs job -<span class="built_in">kill</span> -task &lt;task-id&gt;   杀死任务。被杀死的任务不会不利于失败尝试。</span><br><span class="line">        hdfs job -fail -task &lt;task-id&gt;   使任务失败。被失败的任务会对失败尝试不利。</span><br><span class="line"></span><br><span class="line">    第五部分：运行pipies作业</span><br><span class="line">        hdfs pipes -conf &lt;path&gt; 作业的配置</span><br><span class="line">        hdfs pipes -jobconf &lt;key=value&gt;, &lt;key=value&gt;, ...  增加/覆盖作业的配置项</span><br><span class="line">        hdfs pipes -input &lt;path&gt;  输入目录</span><br><span class="line">        hdfs pipes -output &lt;path&gt; 输出目录</span><br><span class="line">        hdfs pipes -jar &lt;jar file&gt; Jar文件名</span><br><span class="line">        hdfs pipes -inputformat &lt;class&gt; InputFormat类</span><br><span class="line">        hdfs pipes -map &lt;class&gt; Java Map类</span><br><span class="line">        hdfs pipes -partitioner &lt;class&gt; Java Partitioner</span><br><span class="line">        hdfs pipes -reduce &lt;class&gt; Java Reduce类</span><br><span class="line">        hdfs pipes -writer &lt;class&gt; Java RecordWriter</span><br><span class="line">        hdfs pipes -program &lt;executable&gt; 可执行程序的URI</span><br><span class="line">        hdfs pipes -reduces &lt;num&gt; reduce个数</span><br><span class="line"></span><br><span class="line">2. 运维命令</span><br><span class="line">    整体启动：</span><br><span class="line">        命令：</span><br><span class="line">            一次性：</span><br><span class="line">                start-all.sh、stop-all.sh</span><br><span class="line">            分功能（推荐）：</span><br><span class="line">                [hdfs] start-dfs.sh、stop-dfs.sh</span><br><span class="line">                    master: NameNode(NN)、SecondaryNamenode(SNN)</span><br><span class="line">                    slave(s): DataNode(DN)</span><br><span class="line">                [yarn] start-yarn.sh、stop-yarn.sh</span><br><span class="line">                    master: ResourceManager(RM)</span><br><span class="line">                    slave(s): NodeManager(NM)</span><br><span class="line">            集群服务守护进程</span><br><span class="line">                jps 查看</span><br><span class="line"></span><br><span class="line">        背后的逻辑：</span><br><span class="line">            /soft/hadoop/sbin/start-all.sh   </span><br><span class="line">            --------------    </span><br><span class="line">                bin=`dirname <span class="string">&quot;<span class="variable">$&#123;BASH_SOURCE-$0&#125;</span>&quot;</span>`   //&#123;BASH_SOURCE-<span class="variable">$0</span>&#125;代表取得当前执行的shell文件所在的完整路径：/soft/hadoop/sbin/start-all.sh</span><br><span class="line">                libexec/hadoop-config.sh</span><br><span class="line">                hadoop/sbin/start-dfs.sh</span><br><span class="line">                hadoop/sbin/start-yarn.sh</span><br><span class="line"></span><br><span class="line">            sbin/start-dfs.sh</span><br><span class="line">            --------------</span><br><span class="line">                libexec/hadoop-config.sh</span><br><span class="line">                sbin/hadoop-daemons.sh --config .. --hostname .. start namenode ...</span><br><span class="line">                sbin/hadoop-daemons.sh --config .. --hostname .. start datanode ...</span><br><span class="line">                sbin/hadoop-daemons.sh --config .. --hostname .. start sescondarynamenode ...</span><br><span class="line">                sbin/hadoop-daemons.sh --config .. --hostname .. start zkfc ...         //</span><br><span class="line"></span><br><span class="line">            sbin/start-yarn.sh</span><br><span class="line">            --------------  </span><br><span class="line">                libexec/yarn-config.sh</span><br><span class="line">                sbin/yarn-daemon.sh --config <span class="variable">$YARN_CONF_DIR</span>  start resourcemanager</span><br><span class="line">                sbin/yarn-daemons.sh  --config <span class="variable">$YARN_CONF_DIR</span>  start nodemanager</span><br><span class="line"></span><br><span class="line">            sbin/hadoop-daemons.sh</span><br><span class="line">            ----------------------</span><br><span class="line">                libexec/hadoop-config.sh</span><br><span class="line">                slaves</span><br><span class="line">                hadoop-daemon.sh</span><br><span class="line"></span><br><span class="line">            sbin/hadoop-daemon.sh</span><br><span class="line">            -----------------------</span><br><span class="line">                libexec/hadoop-config.sh</span><br><span class="line">                bin/hdfs ....</span><br><span class="line"></span><br><span class="line">            sbin/yarn-daemon.sh</span><br><span class="line">            -----------------------</span><br><span class="line">                libexec/yarn-config.sh</span><br><span class="line">                bin/yarn</span><br><span class="line"></span><br><span class="line">    单独启动和关闭hadoop服务</span><br><span class="line">        1）启动名称节点</span><br><span class="line">            hadoop-daemon.sh start namenode</span><br><span class="line">        2）启动数据节点</span><br><span class="line">            1.在名称节点上进行启动用：hadoop-daemons.sh start datanode      //可一次性启动全部数据节点</span><br><span class="line">            2.在数据节点上进行单个启动用：hadoop-daemon.sh start datanode     //可逐一启动全部数据节点</span><br><span class="line">        3）启动次要名称节点      </span><br><span class="line">            hadoop-daemon.sh start secondarynamenode                    //名称节点上启用</span><br><span class="line">       4）停止一个数据节点</span><br><span class="line">            hadoop-daemon.sh stop datanode //在数据节点上单点操作 </span><br><span class="line">            hadoop-daemons.sh stop datanode //在名称节点上多点操作</span><br><span class="line">        5）启动resourcemanager</span><br><span class="line">            yarn-daemon.sh start resourcemanager //名称节点上启用</span><br><span class="line">        6）启动nodemanager </span><br><span class="line">            bin/yarn-daemons.sh start nodemanager           //在名称节点上启用全部数据节点</span><br><span class="line"> </span><br><span class="line">    安全模式： </span><br><span class="line">        NameNode在启动时会自动进入安全模式，安全模式是NameNode的一种状态，在这个阶段，文件系统不允许有任何修改。</span><br><span class="line">        系统显示Name node <span class="keyword">in</span> safe mode，说明系统正处于安全模式，这时只需要等待几十秒即可。</span><br><span class="line">        1. 退出安全模式：</span><br><span class="line">            hadoop dfsadmin -safemode leave</span><br><span class="line">        2. 进入安全模式：</span><br><span class="line">            hadoop dfsadmin -safemode enter</span><br><span class="line"> </span><br><span class="line">3. 常用 hadoop 和 hdfs 命令</span><br><span class="line">    bin/hadoop</span><br><span class="line">    ------------------------</span><br><span class="line">        hadoop verion       //版本</span><br><span class="line">        hadoop fs           //运行一个常用的文件系统客户端.</span><br><span class="line">        hadoop jar          //运行jar包</span><br><span class="line">        distcp              ？//递归拷贝文件或目录</span><br><span class="line">        hadoop classpath    //设置类路径</span><br><span class="line">        hadoop checknative  //检测本地的库文件</span><br><span class="line"></span><br><span class="line">    bin/hdfs</span><br><span class="line">    ------------------------</span><br><span class="line">        dfs                     // === hadoop fs</span><br><span class="line">        classpath          </span><br><span class="line">        namenode -format   </span><br><span class="line">        secondarynamenode  </span><br><span class="line">        namenode           </span><br><span class="line">        journalnode        </span><br><span class="line">        zkfc               </span><br><span class="line">        datanode           </span><br><span class="line">        dfsadmin           </span><br><span class="line">        haadmin            </span><br><span class="line">        fsck               </span><br><span class="line">        balancer           </span><br><span class="line">        jmxget             </span><br><span class="line">        mover              </span><br><span class="line"></span><br><span class="line">        oiv                </span><br><span class="line">        oiv_legacy         </span><br><span class="line">        oev                </span><br><span class="line">        fetchdt            </span><br><span class="line">        getconf            </span><br><span class="line">        groups             </span><br><span class="line">        snapshotDiff       </span><br><span class="line"></span><br><span class="line">        lsSnapshottableDir </span><br><span class="line"></span><br><span class="line">        portmap            </span><br><span class="line">        nfs3               </span><br><span class="line">        cacheadmin         </span><br><span class="line">        crypto             </span><br><span class="line">        storagepolicies    </span><br><span class="line">        version </span><br><span class="line">    hdfs 常用命令举例： </span><br><span class="line">        $&gt;hdfs dfs -mkdir - p /user/icss/hadoop                 //p递归创建</span><br><span class="line">        $&gt;hdfs dfs -ls -R /user/icss/hadoop                    //-R递归</span><br><span class="line">        $&gt;hdfs dfs -rm -r -f /user/icss/hadoop                // 强制？删除目录</span><br><span class="line">            hdfs 都发生 -rmr /user/icss/hadoop </span><br><span class="line">            删除hadoop上指定文件</span><br><span class="line">                hdfs  dfs –rm [文件地址]</span><br><span class="line">                    hdfs dfs –rm /user/t/ok.txt</span><br><span class="line">            删除hadoop上指定文件夹（包含子目录等）</span><br><span class="line">                hdfs dfs –rm [目录地址]</span><br><span class="line">                    hdfs dfs –rmr /user/t</span><br><span class="line">        $&gt;hdfs dfs --<span class="built_in">help</span>                       //查看帮助</span><br><span class="line">        $&gt;hdfs dfs -ls -R   /                   //显示目录结构</span><br><span class="line">        $&gt;hdfs dfs -lsr /                       //显示目录结构</span><br><span class="line">        $&gt;hdfs dfs -put 1.txt 2.txt /user/icss    //本地文件上传到hdfs文件</span><br><span class="line">        $&gt;hdfs dfs -get /user/icss/1.txt a.txt    //下载hdfs文件到本地</span><br><span class="line">        $&gt;hdfs dfs –getmerge /user /home/t      //将hadoop指定目录下所有内容保存为一个文件，同时down至本地</span><br><span class="line">        $&gt;hdfs dfs -cat /hdfs上一个文本文件        //显示hdfs上文件内容</span><br><span class="line">        $&gt;hdfs dfs -touchz /hdfs上一个文件名      //在hdfs上新建一个空文件</span><br><span class="line">        $&gt;hdfs dfs -mv /data/test03.txt /data/test.txt      //将hadoop上某个文件重命名</span><br><span class="line">        $&gt;hadoop job –<span class="built_in">kill</span>  [job-id]        //将正在运行的hadoop作业<span class="built_in">kill</span>掉</span><br><span class="line">        </span><br><span class="line">    补充</span><br><span class="line">        1.对hdfs操作的命令格式是hdfs dfs</span><br><span class="line">            1.1 -ls 表示对hdfs下一级目录的查看</span><br><span class="line">            1.2 -lsr 表示对hdfs目录的递归查看</span><br><span class="line">            1.3 -mkdir 创建目录</span><br><span class="line">            1.4 -put 从Linux上传文件到hdfs</span><br><span class="line">            1.5 -get 从hdfs下载文件到linux</span><br><span class="line">            1.6 -text 查看文件内容</span><br><span class="line">            1.7 -rm 表示删除文件</span><br><span class="line">            1.7 -rmr 表示递归删除文件</span><br><span class="line">        2.hdfs在对数据存储进行block划分时，如果文件大小超过block，那么按照block大小进行划分；不如block size的，划分为一个块，是实际数据大小。</span><br><span class="line">        3.hadoop常用命令：</span><br><span class="line">            hdfs dfs  查看Hadoop HDFS支持的所有命令   </span><br><span class="line">            hdfs dfs –ls  列出目录及文件信息   </span><br><span class="line">            hdfs dfs –lsr  循环列出目录、子目录及文件信息      </span><br><span class="line">            hdfs dfs –tail /user/icss/test.txt  查看最后1KB的内容   </span><br><span class="line">            hdfs dfs –copyFromLocal test.txt /user/icss/test.txt  从本地文件系统复制文件到HDFS文件系统，等同于put命令   </span><br><span class="line">            hdfs dfs –copyToLocal /user/icss/test.txt test.txt  从HDFS文件系统复制文件到本地文件系统，等同于get命令   </span><br><span class="line">            hdfs dfs –chgrp [-R] /user/icss  修改HDFS系统中/user/icss目录所属群组，选项-R递归执行，跟linux命令一样   </span><br><span class="line">            hdfs dfs –chown [-R] /user/icss  修改HDFS系统中/user/icss目录拥有者，选项-R递归执行   </span><br><span class="line">            hdfs dfs –chmod [-R] MODE /user/icss  修改HDFS系统中/user/sunlightcs目录权限，MODE可以为相应权限的3位数或+/-&#123;rwx&#125;，选项-R递归执行</span><br><span class="line">            hdfs dfs –count [-q] PATH  查看PATH目录下，子目录数、文件数、文件大小、文件名/目录名   </span><br><span class="line">            hdfs dfs –cp SRC [SRC …] DST       将文件从SRC复制到DST，如果指定了多个SRC，则DST必须为一个目录   </span><br><span class="line">            hdfs dfs –du PATH  显示该目录中每个文件或目录的大小   </span><br><span class="line">            hdfs dfs –dus PATH  类似于du，PATH为目录时，会显示该目录的总大小   </span><br><span class="line">            hdfs dfs –expunge  清空回收站，文件被删除时，它首先会移到临时目录.Trash/中，当超过延迟时间之后，文件才会被永久删除   </span><br><span class="line">            hdfs dfs –getmerge SRC [SRC …] LOCALDST [addnl]   获取由SRC指定的所有文件，将它们合并为单个文件，并写入本地文件系统中的LOCALDST，选项addnl将在每个文件的末尾处加上一个换行符   </span><br><span class="line">            hdfs dfs –<span class="built_in">test</span> –[ezd] PATH     对PATH进行如下类型的检查：-e PATH是否存在，如果PATH存在，返回0，否则返回1；-z 文件是否为空，如果长度为0，返回0，否则返回1； -d 是否为目录，如果PATH为目录，返回0，否则返回1  </span><br><span class="line">            hdfs dfs –text PATH  显示文件的内容，当文件为文本文件时，等同于cat；文件为压缩格式（gzip以及hadoop的二进制序列文件格式）时，会先解压缩    </span><br><span class="line">            hdfs dfs –<span class="built_in">help</span> ls  查看某个[ls]命令的帮助文档</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">Hadoop 3 端口号的改变</span><br><span class="line">    分类 	应用 	Haddop 2.x port 	Haddop 3 port</span><br><span class="line">    NNPorts 	Namenode 	8020 	9820</span><br><span class="line">    NNPorts 	NN HTTP UI 	50070 	9870</span><br><span class="line">    NNPorts 	NN HTTPS UI 	50470 	9871</span><br><span class="line">    SNN ports 	SNN HTTP 	50091 	9869</span><br><span class="line">    SNN ports 	SNN HTTP UI 	50090 	9868</span><br><span class="line">    DN ports 	DN IPC 	50020 	9867</span><br><span class="line">    DN ports 	DN 	50010 	9866</span><br><span class="line">    DN ports 	DN HTTP UI 	50075 	9864</span><br><span class="line">    DN ports 	Namenode 	50475 	9865</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">https://blog.csdn.net/weixin_43215250/article/details/84819692</span><br><span class="line">    https://www.csdn.net/gather_25/MtTaYg0sNDI3Mi1ibG9n.html</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="可能出现的问题"><a href="#可能出现的问题" class="headerlink" title="可能出现的问题"></a>可能出现的问题</h2><h4 id="1-没有datanode节点"><a href="#1-没有datanode节点" class="headerlink" title="1. 没有datanode节点"></a>1. 没有datanode节点</h4><p><img src="https://i.niupic.com/images/2021/07/30/9psQ.png"></p>
<p><img src="https://i.niupic.com/images/2021/07/30/9psP.png"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 正确命令</span></span><br><span class="line"> <span class="comment">## slave</span></span><br><span class="line"> vim /home/vagrant/hadoopdata/dfs/data/current/VERSION</span><br><span class="line"> </span><br><span class="line"> <span class="comment">## master</span></span><br><span class="line"> vim /home/vagrant/hadoopdata/dfs/name/current/VERSION</span><br><span class="line"> 54d59e8e-b002-4ca3-817a-a9f4c8166dc5</span><br><span class="line"> </span><br><span class="line"> <span class="comment">## clusterID 应该要相同,layoutVersion可以不改</span></span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/29/Hadoop/" data-id="ckscnkdsh001hsy5b816lgljq" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Hadoop/" rel="tag">Hadoop</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag">虚拟机</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-虚拟机2" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/28/%E8%99%9A%E6%8B%9F%E6%9C%BA2/" class="article-date">
  <time datetime="2021-07-28T00:48:46.000Z" itemprop="datePublished">2021-07-28</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/28/%E8%99%9A%E6%8B%9F%E6%9C%BA2/">虚拟机2</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h3 id="解决宿主机ping不通客户机"><a href="#解决宿主机ping不通客户机" class="headerlink" title="解决宿主机ping不通客户机"></a>解决宿主机ping不通客户机</h3><ol>
<li>在windows机器上安装新的虚拟网卡</li>
<li>设备管理器 &gt; 网络适配器 &gt; 操作 &gt; 添加过时硬件 &gt; 安装我手动从设备列表中 &gt; 网络适配器 &gt; 厂商选择microsoft,型号选择Microsoft KM-TEST 环回网卡</li>
<li>给该新增的网卡设置ip地址<ul>
<li>网络连接 &gt; Microsoft KM-TEST 环回适配器 &gt; 属性 </li>
<li>ip address 192.168.100.100</li>
<li>network mask :255.255.255.0</li>
</ul>
</li>
</ol>
<p>验证 在宿主机ping 192.168.100.100</p>
<ol start="4">
<li><p>在vagrant工作目录中</p>
<ul>
<li><p>新建Linux init &gt; MS Loopback目录</p>
</li>
<li><p>复制Linux init下Vagrant 文件,修改:</p>
<p>ip addresss 和环回网卡同一个子网的另一个ip:如192.168.100.99</p>
<p>改一个新的虚拟机的名称</p>
</li>
</ul>
</li>
<li><p>在上述的vagrantfile文件位置,执行vagrant up,新建一个vm</p>
</li>
<li><p>验证guest的birdge:VirtualBox &gt; 选中当前vm &gt; 将网络中桥接网络改成环回网络 </p>
</li>
</ol>
<h3 id="使用清华大学的Debian源"><a href="#使用清华大学的Debian源" class="headerlink" title="使用清华大学的Debian源"></a>使用清华大学的Debian源</h3><h4 id="清华园的镜像站点"><a href="#清华园的镜像站点" class="headerlink" title="清华园的镜像站点"></a>清华园的镜像站点</h4><ol>
<li><p>清华源镜像站点</p>
</li>
<li><p>配置步骤</p>
<ul>
<li><p>备注源描述文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak</span><br></pre></td></tr></table></figure></li>
<li><p>编辑源描述文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo vim sources.list</span><br></pre></td></tr></table></figure></li>
<li><p>删除已有的内容</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 编辑 源 描述文件</span> </span><br><span class="line">sudo vim sources.list </span><br><span class="line"><span class="meta">#</span><span class="bash"> 删除所有已有的内容, 添加:</span> </span><br><span class="line"><span class="meta">#</span><span class="bash"> 默认注释了源码镜像以提高 apt update 速度，如有需要可自行取消注释</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster main contrib non-free</span><br><span class="line"><span class="meta">#</span><span class="bash"> deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster main contrib non-free</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-updates main contrib non-free</span><br><span class="line"><span class="meta">#</span><span class="bash"> deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-updates main contrib non-free</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-backports main contrib non-free</span><br><span class="line"><span class="meta">#</span><span class="bash"> deb-src https://mirrors.tuna.tsinghua.edu.cn/debian/ buster-backports main contrib non-free</span></span><br><span class="line">deb https://mirrors.tuna.tsinghua.edu.cn/debian-security buster/updates main contrib non-free</span><br><span class="line"><span class="meta">#</span><span class="bash"> deb-src https://mirrors.tuna.tsinghua.edu.cn/debian-security buster/updates main contrib non-free</span></span><br></pre></td></tr></table></figure></li>
<li><p>测试验证</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get update</span><br><span class="line">sudo apt-get upgrade</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="Hadoop"><a href="#Hadoop" class="headerlink" title="Hadoop"></a>Hadoop</h2><h3 id="为在Debian10中安装hadoop-3-x进行环境准备"><a href="#为在Debian10中安装hadoop-3-x进行环境准备" class="headerlink" title="为在Debian10中安装hadoop 3.x进行环境准备"></a>为在Debian10中安装hadoop 3.x进行环境准备</h3><h4 id="1-配置时钟同步"><a href="#1-配置时钟同步" class="headerlink" title="1. 配置时钟同步"></a>1. 配置时钟同步</h4><h4 id="2-配置开机就启动网络"><a href="#2-配置开机就启动网络" class="headerlink" title="2. 配置开机就启动网络"></a>2. 配置开机就启动网络</h4><h4 id="3-配置主机名"><a href="#3-配置主机名" class="headerlink" title="3. 配置主机名"></a>3. 配置主机名</h4>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo hostnamectl set-hostname [主机名] # 修改主机名</span><br><span class="line">ip addr </span><br><span class="line">sudo vim /etc/network/interfaces #所有网卡均为自动启动</span><br><span class="line">sudo vim/ect/resolv.conf # 修改host文件</span><br><span class="line">sudo vim /etc/hosts</span><br><span class="line"><span class="meta"> #</span><span class="bash"> 只保留:</span></span><br><span class="line"> 127.0.0.1   localhost</span><br><span class="line"> 127.0.0.1   master master.hadoop</span><br><span class="line"> 192.168.43.101 master</span><br></pre></td></tr></table></figure>

<h4 id="4-安装jdk"><a href="#4-安装jdk" class="headerlink" title="4. 安装jdk"></a>4. 安装jdk</h4>   <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/java</span><br><span class="line">sudo tar -xzvf jdk-8u291-linux-x64.tar.gz </span><br><span class="line">sudo rm jdk-8u291-linux-x64.tar.gz </span><br><span class="line">cd jdk1.8.0_291/</span><br><span class="line">vim .profile     ## 在文件末尾加入:</span><br><span class="line">    export JAVA_HOME=/usr/java/jdk1.8.0_291</span><br><span class="line">    export PATH=$JAVA_HOME/bin:$PATH</span><br><span class="line"><span class="meta"> #</span><span class="bash"><span class="comment"># 退出vim</span></span> </span><br></pre></td></tr></table></figure>

<h4 id="5-配置ssh免密登陆"><a href="#5-配置ssh免密登陆" class="headerlink" title="5. 配置ssh免密登陆"></a>5. 配置ssh免密登陆</h4><h4 id="6-关闭防火墙-debian10初始没有装任何防火墙"><a href="#6-关闭防火墙-debian10初始没有装任何防火墙" class="headerlink" title="6. 关闭防火墙(debian10初始没有装任何防火墙)"></a>6. 关闭防火墙(debian10初始没有装任何防火墙)</h4><h3 id="单机版-Hadoop-安装"><a href="#单机版-Hadoop-安装" class="headerlink" title="单机版 Hadoop 安装"></a>单机版 Hadoop 安装</h3><h4 id="配配系统"><a href="#配配系统" class="headerlink" title="配配系统"></a>配配系统</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">vim .profile  # 加入： </span><br><span class="line">    # for hadoop</span><br><span class="line">export HADOOP_HOME=/home/vagrant/hadoop3</span><br><span class="line">export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class="line">export HDFS_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class="line">export YARN_HOME=$HOME/hadoop3</span><br><span class="line">export YARN_CONF_DIR=$HADOOP_HOME/etc/hadoop</span><br><span class="line">export HADOOP_COMMON_LIB_NATIVE_DIR=$HADOOP_HOME/lib/native</span><br><span class="line">    export HADOOP_OPTS=&quot;-Djava.library.path=$HADOOP_HOME/lib/native:$HADOOP_COMMON_LIB_NATIVE_DIR&quot;</span><br><span class="line">export PATH=.:$JAVA_HOME/lib:$HADOOP_HOME/bin:$HADOOP_HOME/sbin:$PATH </span><br><span class="line">source .profile</span><br></pre></td></tr></table></figure>


<h4 id="验证-mapreduce-的字符串查询"><a href="#验证-mapreduce-的字符串查询" class="headerlink" title="验证 mapreduce 的字符串查询"></a>验证 mapreduce 的字符串查询</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">hadoop version </span><br><span class="line">cd hadoop3</span><br><span class="line">hdfs dfs -mkdir /input</span><br><span class="line">hdfs dfs -put etc/hadoop/*.xml /input</span><br><span class="line">hadoop jar share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar grep /input /output/xml &#x27;dfs[a-z.]+&#x27;</span><br><span class="line">hdfs dfs -cat output/xml/*</span><br></pre></td></tr></table></figure>

<h4 id="验证-mapreduce-的求pi值"><a href="#验证-mapreduce-的求pi值" class="headerlink" title="验证 mapreduce 的求pi值"></a>验证 mapreduce 的求pi值</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">hadoop jar hadoop3/share/hadoop/mapreduce/hadoop-mapreduce-examples-3.2.2.jar pi 10 10</span><br><span class="line">cat output/xml/*</span><br></pre></td></tr></table></figure>

<h4 id="启动集群服务"><a href="#启动集群服务" class="headerlink" title="启动集群服务"></a>启动集群服务</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta"> #</span><span class="bash"> 0- 格式化 hdfs</span> </span><br><span class="line">hdfs namenode -format</span><br><span class="line"><span class="meta">#</span><span class="bash"> 1- 启动 hadoop 集群服务</span></span><br><span class="line">start-dfs.sh</span><br><span class="line">start-yarn.sh </span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/28/%E8%99%9A%E6%8B%9F%E6%9C%BA2/" data-id="ckscnkdrf000psy5b1hr0foq6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag">虚拟机</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-Docker-in-Linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/27/Docker-in-Linux/" class="article-date">
  <time datetime="2021-07-27T01:11:53.000Z" itemprop="datePublished">2021-07-27</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/27/Docker-in-Linux/">Docker in Linux</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h2><h3 id="Linux发行选取"><a href="#Linux发行选取" class="headerlink" title="Linux发行选取"></a>Linux发行选取</h3><p>kernel + distro(商业Redhat、开源Ubuntu 、Fedora-Server Debian、CentOS、SuSE)</p>
<h4 id="选取要求"><a href="#选取要求" class="headerlink" title="选取要求"></a>选取要求</h4><ul>
<li>开源</li>
<li>Server</li>
<li>lifelive</li>
</ul>
<p>Debian Version 次新版</p>
<h3 id="虚拟化"><a href="#虚拟化" class="headerlink" title="虚拟化"></a>虚拟化</h3><p>硬件级、软件级、操作系统级</p>
<p>软件级:在安装了OS机器上安装软件级的虚拟化支撑软件 VirtualBox</p>
<p>借助虚拟化支撑软件 创建虚拟化硬件机器 在虚拟机上安装 OS</p>
<p><strong>Docker+K8s</strong></p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><h4 id="virtualBox"><a href="#virtualBox" class="headerlink" title="virtualBox"></a>virtualBox</h4><p>设置所有虚拟机放置的位置</p>
<h4 id="Vagrant"><a href="#Vagrant" class="headerlink" title="Vagrant"></a>Vagrant</h4><p>虚拟化软件工具 (<strong>注意版本的一致性</strong>)</p>
<ol>
<li><p>配置</p>
<ul>
<li>VAGRANT_HOME:指定所有boxes存放的目录(boxes仓库)</li>
</ul>
</li>
<li><p>将box(es0加入本地boxes仓库</p>
<p>box的名称为在仓库中的名称</p>
<ul>
<li><p>在线添加</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vagrant box add ...box --name</span><br><span class="line"><span class="meta">#</span><span class="bash"> 便于升级,速度慢</span></span><br></pre></td></tr></table></figure></li>
<li><p>离线添加</p>
</li>
</ul>
</li>
<li><p>完成虚拟机的创建 虚拟机中客户操作系统的安装</p>
<ul>
<li><p>创建Vagrant工作目录 </p>
</li>
<li><p>在工作目录中执行</p>
<ul>
<li><p>vagrant init 你要使用box的仓库名称 —— 生成vagrant配置文件(在当前命令执行的位置下)</p>
</li>
<li><p>创建虚拟机 + 安装box的指定的用户</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vagrant up # 按照vagrantfile描述完成操作</span><br><span class="line"><span class="meta">#</span><span class="bash"> 按需装配vm+vmos 手动编辑vagrantfile文件</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ol>
<p><img src="https://img-blog.csdnimg.cn/17d30327eb1a4a11a57bae3855799e80.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3Ryb3VibGVuYmZyaWVuZA==,size_16,color_FFFFFF,t_70"></p>
<h3 id="连接虚拟机"><a href="#连接虚拟机" class="headerlink" title="连接虚拟机"></a>连接虚拟机</h3><ol>
<li><p>借助vagrant</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant ssh </span><br></pre></td></tr></table></figure></li>
<li><p>借助OS ssh客户端(加密的telent client)</p>
<p>OS 已经安装了ssh 软件(open ssh)</p>
<p>使用ssh 命令远程连接Linux主机</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh -p 端口号 用户名@机器地址</span><br></pre></td></tr></table></figure></li>
</ol>
<h2 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h2><h3 id="常用命令"><a href="#常用命令" class="headerlink" title="常用命令"></a>常用命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">su - [用户名] # 切换用户</span><br><span class="line">grep lang anaconda-ks.cfg # 在anaconda-ks.cfg中查找lang</span><br><span class="line">grep lang anaconda-ks.cfg --color # 高亮显示</span><br><span class="line">netstat -ano|more # 查看网络信息</span><br><span class="line">jps #  查看正在运行的java程序</span><br><span class="line">vagrant suspend # 保存虚拟机状态到硬盘 </span><br><span class="line">vagrant halt #关闭虚拟机 </span><br><span class="line">vagrant reload # 重启虚拟机 </span><br><span class="line">vagrant resume # 激活挂起的虚拟机 </span><br><span class="line">vagrant destroy #销毁当前项目创建的虚拟机 </span><br><span class="line">vagrant up #启动虚拟机</span><br><span class="line">tar -xzvf # 解压缩</span><br></pre></td></tr></table></figure>

<h3 id="Linux系统环境变量"><a href="#Linux系统环境变量" class="headerlink" title="Linux系统环境变量"></a>Linux系统环境变量</h3><ul>
<li>/etc/profile(系统所有用户均需要的环境变量)</li>
<li>/etc/bash.bashrc</li>
<li>.profile(当前用户所需要的环境变量)</li>
<li>.bashrc</li>
</ul>
<h3 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">sudo apt-get -y update </span><br><span class="line">sudo apt-get -y upgrade</span><br><span class="line">sudo apt-get remove docker docker-engine docker.io containerd runc</span><br><span class="line"></span><br><span class="line">sudo apt-get install \</span><br><span class="line">    apt-transport-https \</span><br><span class="line">    ca-certificates \</span><br><span class="line">    curl \</span><br><span class="line">    gnupg \</span><br><span class="line">    lsb-release #Update the apt package index and install packages to allow apt to use a repository over HTTPS:</span><br><span class="line">    </span><br><span class="line">curl -fsSL https://download.docker.com/linux/debian/gpg | sudo gpg --dearmor -o /usr/share/keyrings/docker-archive-keyring.gpg # Add Docker’s official GPG key:</span><br><span class="line"></span><br><span class="line">echo \</span><br><span class="line">  &quot;deb [arch=amd64 signed-by=/usr/share/keyrings/docker-archive-keyring.gpg] https://download.docker.com/linux/debian \</span><br><span class="line"><span class="meta">  $</span><span class="bash">(lsb_release -cs) stable<span class="string">&quot; | sudo tee /etc/apt/sources.list.d/docker.list &gt; /dev/null</span></span></span><br><span class="line"></span><br><span class="line">sudo apt-get install docker-ce docker-ce-cli containerd.io</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sudo docker pull mysql</span><br><span class="line">sudo docker pull redis</span><br><span class="line">sudo docker pull mongo</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="验证"><a href="#验证" class="headerlink" title="验证"></a>验证</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo systemctl status|start|stop|restart docker.service</span><br><span class="line">sudo systemctl enable|disable docker.service</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker -v</span><br><span class="line">docker --version</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run hello-world</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker ps -a # 查看所有进程</span><br></pre></td></tr></table></figure>

<h3 id="Mysql-Docker"><a href="#Mysql-Docker" class="headerlink" title="Mysql Docker"></a>Mysql Docker</h3><h4 id="使用mysql"><a href="#使用mysql" class="headerlink" title="使用mysql"></a>使用mysql</h4><h4 id="run"><a href="#run" class="headerlink" title="run"></a>run</h4><p>后台方式启动mysql,指定container的名字、mysql、密码、端口映射</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run -d --name mymysql -p 3333:3306 -e MYSQL_ROOT_PASSWORD=root mysql #将docker 端口好的3306映射到虚拟机的3333端口,并且设置mysql的密码,并且设置这个docker服务叫做mysql</span><br></pre></td></tr></table></figure>

<p>验证</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo docker ps -a</span><br><span class="line">sudo docker</span><br></pre></td></tr></table></figure>

<p>删除container</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker container rm -f [containerName]</span><br></pre></td></tr></table></figure>

<p>交互方式进入container</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo docker container exec -it  mymysql bash</span><br></pre></td></tr></table></figure>

<p>后台方式启动,启动本地配置文件、本地数据文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sudo docker run \</span><br><span class="line">  -p 3306:3306 \</span><br><span class="line">  -d \</span><br><span class="line">  --name mymysql \</span><br><span class="line">  -v /home/vagrant/projectdata/mysql/conf:/etc/mysql/conf.d \</span><br><span class="line">  -v /home/vagrant/projectdata/mysql/logs:/logs \</span><br><span class="line">  -v /home/vagrant/projectdata/mysql/data:/var/lib/mysql \</span><br><span class="line">  -e MYSQL_ROOT_PASSWORD=root \</span><br><span class="line">  mysql</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/27/Docker-in-Linux/" data-id="ckscnkdpf0001sy5b8x21flpf" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Docker/" rel="tag">Docker</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-虚拟机" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/26/%E8%99%9A%E6%8B%9F%E6%9C%BA/" class="article-date">
  <time datetime="2021-07-26T01:25:36.000Z" itemprop="datePublished">2021-07-26</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/26/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="虚拟环境的搭建、准备"><a href="#虚拟环境的搭建、准备" class="headerlink" title="虚拟环境的搭建、准备"></a>虚拟环境的搭建、准备</h2><h3 id="Linux发行版"><a href="#Linux发行版" class="headerlink" title="Linux发行版"></a>Linux发行版</h3><p>GNU/Linux ——&gt; OS kernel</p>
<p>distro ——&gt; OS</p>
<p>Debian stable 10</p>
<h4 id="商业"><a href="#商业" class="headerlink" title="商业"></a>商业</h4><ol>
<li>Redhat</li>
</ol>
<h4 id="开源"><a href="#开源" class="headerlink" title="开源"></a>开源</h4><ol>
<li><p>Ubuntu / Debian</p>
</li>
<li><p>Fedora / CentOS</p>
</li>
<li><p>CentOS</p>
</li>
<li><p>Dedian</p>
</li>
<li><p>SuSE</p>
</li>
</ol>
<h3 id="如何在Linux工作"><a href="#如何在Linux工作" class="headerlink" title="如何在Linux工作"></a>如何在Linux工作</h3><ol>
<li><p>安装了Linux OS的主机</p>
<ul>
<li>亲身接触</li>
</ul>
</li>
<li><p>基于云主机、云平台提供的vps(<strong>虚拟化</strong>)</p>
<ul>
<li>借助网络、远程终端.连接、操作</li>
</ul>
</li>
<li><p>本地主机上安装虚拟化软件的机器(宿主机OS)</p>
<ul>
<li>安装Linux(客户OS —— GuestOS)</li>
</ul>
</li>
</ol>
<h3 id="虚拟化技术"><a href="#虚拟化技术" class="headerlink" title="虚拟化技术"></a>虚拟化技术</h3><ol>
<li><p>硬件级——Hypervisor</p>
<ul>
<li><p>VMWare ESXi</p>
</li>
<li><p>Cirtrix XEM 直接安装在裸机上</p>
</li>
<li><p>Hyper-V</p>
</li>
</ul>
</li>
<li><p>软件级</p>
<ul>
<li>VMWare Workstation </li>
<li>Oracle VirtualBox 安装在宿主机OS</li>
<li>虚拟化一台全功能、全配置的硬件计算机,在该计算机(虚拟计算机、Guest)安装软件</li>
</ul>
</li>
<li><p>OS级虚拟机——Docker</p>
<ul>
<li>轻量级虚拟化,虚拟出一个需要的软件环境</li>
</ul>
</li>
</ol>
<h3 id="软件级的虚拟化"><a href="#软件级的虚拟化" class="headerlink" title="软件级的虚拟化"></a>软件级的虚拟化</h3><ol>
<li>Hyper-V</li>
</ol>
<p>wsl、wsl2</p>
<ol start="2">
<li><p><strong>VirtualBox ——开源软件</strong></p>
</li>
<li><p>VMWare Workstation</p>
</li>
</ol>
<h2 id="定位-具体的实现涉及的软件和步骤"><a href="#定位-具体的实现涉及的软件和步骤" class="headerlink" title="定位(具体的实现涉及的软件和步骤)"></a>定位(具体的实现涉及的软件和步骤)</h2><p>VirtualBox : 虚拟机创建、管理软件,类似于VMware;开源</p>
<p>Vagrant : 创建和部署虚拟化(Guest OS)开发环境</p>
<p>Hadoop : 大数据存储、分析的基础环境、选取Apache分发版本</p>
<h3 id="破题"><a href="#破题" class="headerlink" title="破题"></a>破题</h3><ol>
<li>借助Vagrant 管理基于VirtualBox中的虚拟机,并在其上安装Linux,在Linux中安装Hadoop</li>
</ol>
<h2 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h2><h3 id="系统环境的搭建"><a href="#系统环境的搭建" class="headerlink" title="系统环境的搭建"></a>系统环境的搭建</h3><ol>
<li>VirtualBox 安装</li>
<li>配置</li>
</ol>
<h3 id="虚拟环境的搭建"><a href="#虚拟环境的搭建" class="headerlink" title="虚拟环境的搭建"></a>虚拟环境的搭建</h3><h4 id="1-Debian-下载-创建虚拟机"><a href="#1-Debian-下载-创建虚拟机" class="headerlink" title="1. Debian 下载,创建虚拟机"></a>1. Debian 下载,创建虚拟机</h4><h5 id="创建"><a href="#创建" class="headerlink" title="创建"></a>创建</h5><ul>
<li>disktype : vdi ==单一文件</li>
</ul>
<h5 id="设置"><a href="#设置" class="headerlink" title="设置"></a>设置</h5><ul>
<li><p>存储选择Debian10 dvd.iso文件</p>
</li>
<li><p>网络:桥接网卡,界面 ;当前宿主机的连接外网的网卡名称</p>
</li>
</ul>
<h5 id="启动-正常启动"><a href="#启动-正常启动" class="headerlink" title="启动:正常启动"></a>启动:正常启动</h5><ul>
<li><p>将所有文件放在同一个分区中-结束分区设定并将修改写入磁盘</p>
</li>
<li><p>不扫描其他CD</p>
</li>
<li><p>不使用网络镜像</p>
<ul>
<li>暂时不用!!!,启动并进入Debian后,手动指定并设置国内镜像源</li>
</ul>
</li>
<li><p>软件选择: ssh serve 和标准系统工具</p>
</li>
<li><p>将GRUB…MBR上  是</p>
<ul>
<li>/dev/sda 虚拟机第一个硬盘</li>
</ul>
</li>
</ul>
<h5 id="重启"><a href="#重启" class="headerlink" title="重启"></a>重启</h5><h5 id="配置Debian10"><a href="#配置Debian10" class="headerlink" title="配置Debian10"></a>配置Debian10</h5><ul>
<li>hostname</li>
<li>静态ip address</li>
<li>借助Vagrant安装debian10</li>
</ul>
<h5 id="推荐的书-——《鸟叔的私房菜》"><a href="#推荐的书-——《鸟叔的私房菜》" class="headerlink" title="推荐的书 ——《鸟叔的私房菜》"></a>推荐的书 ——《<strong>鸟叔的私房菜</strong>》</h5><h4 id="2-安装Linux、Xshell"><a href="#2-安装Linux、Xshell" class="headerlink" title="2. 安装Linux、Xshell"></a>2. 安装Linux、Xshell</h4><h4 id="3-安装Vagrant"><a href="#3-安装Vagrant" class="headerlink" title="3. 安装Vagrant"></a>3. 安装Vagrant</h4><ol>
<li>下载box加入vagrant <a target="_blank" rel="noopener" href="https://www.vagrantup.com/">网址</a></li>
<li>安装<ul>
<li>stepbystep</li>
</ul>
</li>
<li>设置<ul>
<li>所有的 Vagrant box 文件所在的位置</li>
</ul>
</li>
</ol>
<h4 id="4-Hadoop基础环境搭建"><a href="#4-Hadoop基础环境搭建" class="headerlink" title="4. Hadoop基础环境搭建"></a>4. Hadoop基础环境搭建</h4><h4 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h4><p>基于vagrant+virtualBox 安装配置Debian</p>
<ol>
<li><p>安装VirtualBox(最新版)</p>
<ul>
<li>设置 :常规 &gt; 默认虚拟电脑位置</li>
</ul>
</li>
<li><p>安装vagrant</p>
<ul>
<li>设置系统环境变量 ==&gt; VAGRABT_HOME </li>
</ul>
</li>
<li><p>下载并且添加box到Vagrant中</p>
<ul>
<li>deban10.3.3.2     –name generic/debian10</li>
<li>下载 .box文件</li>
</ul>
</li>
<li><p>执行<code>vagrant box add [下载另存为的文件名] --anme geenric/debian10</code></p>
</li>
<li><p>做初始化待安装的debiao10虚拟机</p>
<ul>
<li><p>创建一个文件夹(位置任意,以后要包含vagrantfile文件,要一句vagrantfile文件创建并且生成虚拟机)</p>
</li>
<li><p>在该文件夹位置进入命令行,执行</p>
<p><code>vagrant init generic/debian10</code></p>
<p>在当前位置生成一个vagrantfile的虚拟机创建所需的文件</p>
</li>
</ul>
</li>
<li><p>编辑刚刚生成的Vagrantfile文件,配置虚拟机的硬件、软件</p>
<ul>
<li><p>安装两个插件:</p>
<ul>
<li><p>disksize </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">vagrant plugin install vagrant -disksize</span><br><span class="line">vagrant plugin install --plugin-clean-sources --plugin-source https://gems.ruby-china.com/ vagrant-disksize</span><br></pre></td></tr></table></figure></li>
<li><p>virtualboxguest : </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vagrant plugin install --plugin-clean-sources --plugin-source https://gems.ruby-china.com/ vagrant-vbguest</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p>修改为你的ip 地址和网卡名称</p>
</li>
<li><p>在硬盘上创建用于双向共享的文件夹填入目录中</p>
</li>
<li><p>在该文件所在的位置,进入命令行,执行vagrant up</p>
</li>
</ul>
</li>
<li><p>在该文件夹位置,进入命令行,执行:</p>
<p><code>vagrant up</code></p>
<ul>
<li>在VB指定的“默认虚拟电脑位置”,直接在VB执行<code>vagrant ssh </code></li>
</ul>
</li>
</ol>
<h3 id="Hadoop基础环境的搭配"><a href="#Hadoop基础环境的搭配" class="headerlink" title="Hadoop基础环境的搭配"></a>Hadoop基础环境的搭配</h3><h3 id="Hadoop单机版、伪分布式、全分布式-集群-环境搭建"><a href="#Hadoop单机版、伪分布式、全分布式-集群-环境搭建" class="headerlink" title="Hadoop单机版、伪分布式、全分布式(集群)环境搭建"></a>Hadoop单机版、伪分布式、全分布式(集群)环境搭建</h3>
      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/26/%E8%99%9A%E6%8B%9F%E6%9C%BA/" data-id="ckscnkdr9000nsy5b8nogb6y4" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Linux/" rel="tag">Linux</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-第十一天" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/24/%E7%AC%AC%E5%8D%81%E4%B8%80%E5%A4%A9/" class="article-date">
  <time datetime="2021-07-24T06:25:22.000Z" itemprop="datePublished">2021-07-24</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/24/%E7%AC%AC%E5%8D%81%E4%B8%80%E5%A4%A9/">第十一天</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="selenium"><a href="#selenium" class="headerlink" title="selenium"></a>selenium</h2><h3 id="安装WebDriver"><a href="#安装WebDriver" class="headerlink" title="安装WebDriver"></a>安装WebDriver</h3><p>针对某一个特定的浏览器版本</p>
<p>各浏览器下载地址：（注意版本）</p>
<ul>
<li>Firefox浏览器驱动：geckodriver：<a target="_blank" rel="noopener" href="https://github.com/mozilla/geckodriver/releases">link</a></li>
<li>Chrome浏览器驱动：<ul>
<li>chromedrivert：<a target="_blank" rel="noopener" href="https://sites.google.com/a/chromium.org/chromedriver/home">link</a></li>
<li>Taobao备用地址：<a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/chromedriver">link</a></li>
</ul>
</li>
<li>IE浏览器驱动：IEDriverServer：<a target="_blank" rel="noopener" href="http://selenium-release.storage.googleapis.com/index.html">link</a></li>
<li>Edge浏览器驱动：MicrosoftWebDriver：<a target="_blank" rel="noopener" href="https://developer.microsoft.com/en-us/microsoft-edge/tools/webdriver/">link</a></li>
<li>Opera浏览器驱动：operadriver：<a target="_blank" rel="noopener" href="https://github.com/operasoftware/operachromiumdriver/releases">link</a></li>
<li>PhantomJS浏览器驱动：phantomjs：<a target="_blank" rel="noopener" href="http://phantomjs.org/">link</a></li>
</ul>
<h3 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h3><ol>
<li>发送键盘操作:组合键….</li>
<li>发送鼠标操作: 左键、右键、单击拖动</li>
<li>无头模式: headless</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/24/%E7%AC%AC%E5%8D%81%E4%B8%80%E5%A4%A9/" data-id="ckscnkdr2000isy5b3r0iaj1t" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" rel="tag">浏览器</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-第十天" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/23/%E7%AC%AC%E5%8D%81%E5%A4%A9/" class="article-date">
  <time datetime="2021-07-23T00:38:27.000Z" itemprop="datePublished">2021-07-23</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/23/%E7%AC%AC%E5%8D%81%E5%A4%A9/">第十天</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h2 id="Json-String解析"><a href="#Json-String解析" class="headerlink" title="Json String解析"></a>Json String解析</h2><h3 id="动态页面"><a href="#动态页面" class="headerlink" title="动态页面"></a>动态页面</h3><h4 id="判断"><a href="#判断" class="headerlink" title="判断"></a>判断</h4><ol>
<li>页面内容加载延迟</li>
<li>在html_text不包含页面中显示的文字内容</li>
</ol>
<h4 id="分析、获取页面文字内容的请求url"><a href="#分析、获取页面文字内容的请求url" class="headerlink" title="分析、获取页面文字内容的请求url"></a>分析、获取页面文字内容的请求url</h4><p><strong>F12 +Network refresh search 搜索 + 已加载的动态页面内容 标头 url</strong></p>
<p>精简url</p>
<p><code>https://club.jd.com/comment/productPageComments.action?callback=fetchJSON_comment98&amp;productId=100023014936&amp;score=0&amp;sortType=5&amp;page=0&amp;pageSize=10&amp;isShadowSku=0&amp;fold=1</code></p>
<ul>
<li><code>callback=fetchJSON_comment98</code></li>
<li><code>isShadowSku=0</code></li>
<li><code>fold=1</code></li>
</ul>
<p><code>https://club.jd.com/comment/productPageComments.action?productId=100023014936&amp;score=0&amp;sortType=5&amp;page=0&amp;pageSize=10</code></p>
<h4 id="获取json字符串"><a href="#获取json字符串" class="headerlink" title="获取json字符串"></a>获取json字符串</h4><p>发送精简url ——&gt; Json </p>
<p>Json string 进行结构化</p>
<p><code>json.cn</code></p>
<h4 id="解析、定位、提取"><a href="#解析、定位、提取" class="headerlink" title="解析、定位、提取"></a>解析、定位、提取</h4><p>获取京东某个商品的某一页的所有评论文字</p>
<h3 id="JSON-字符串—硬编码"><a href="#JSON-字符串—硬编码" class="headerlink" title="JSON 字符串—硬编码"></a>JSON 字符串—硬编码</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;name&quot;</span>: <span class="string">&quot;zhangsan&quot;</span>, </span><br><span class="line">  <span class="attr">&quot;age&quot;</span>: <span class="number">20</span>, </span><br><span class="line">  <span class="attr">&quot;like&quot;</span>: [<span class="string">&quot;sing&quot;</span>, <span class="string">&quot;dance&quot;</span>, <span class="string">&quot;swim&quot;</span>], </span><br><span class="line">  <span class="attr">&quot;scores&quot;</span>: </span><br><span class="line">  		&#123;</span><br><span class="line">        <span class="attr">&quot;chinese&quot;</span>: <span class="number">80</span>,</span><br><span class="line">       	<span class="attr">&quot;math&quot;</span>: <span class="number">60</span>, </span><br><span class="line">       	<span class="attr">&quot;english&quot;</span>: <span class="number">99</span></span><br><span class="line">      &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="范围"><a href="#范围" class="headerlink" title="范围"></a>范围</h4><p>{ Json string content }</p>
<h4 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h4><p>语言对应 json —— entity —— 语言数据结构</p>
<ul>
<li><p>python:</p>
<pre><code>    json ——&gt; dict  
</code></pre>
</li>
<li><p>java</p>
<p>​        java  ——&gt; entity</p>
</li>
</ul>
<p>对象 &lt;实体&gt; 元素</p>
<p>key : value</p>
<ul>
<li>key ——字符串,必须要用<strong>双引号</strong>包裹</li>
<li>value——任何一种数据元素<ul>
<li>字符串——‘“ ”</li>
<li>数值——数字</li>
<li>对象元素——{ }</li>
<li>数组—— [ ]</li>
</ul>
</li>
</ul>
<p>数组&lt;列表&gt;元素:多个实例对象</p>
<ul>
<li><p>[对象元素,对象元素]</p>
</li>
<li><p>使用[ ]包含多个对象元素</p>
</li>
<li><p>表示复杂的类型嵌套 —— JSON 对应的实体的关联关系</p>
</li>
</ul>
<h4 id="目的"><a href="#目的" class="headerlink" title="目的"></a>目的</h4><p>json string —— var (反序列化)</p>
<ul>
<li>提取json string中key对应的value</li>
</ul>
<p>var —— json string (序列化)</p>
<ul>
<li>生成json string</li>
</ul>
<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><h4 id="json-string-来源"><a href="#json-string-来源" class="headerlink" title="json string 来源"></a>json string 来源</h4><p>json_str=</p>
<ol>
<li>常量字符串直接赋值</li>
<li>读取(url、file)–间接获取</li>
</ol>
<h4 id="反序列化"><a href="#反序列化" class="headerlink" title="反序列化"></a>反序列化</h4><h5 id="json-str-直接赋值"><a href="#json-str-直接赋值" class="headerlink" title="json_str 直接赋值"></a>json_str 直接赋值</h5><ol>
<li><p>导包</p>
</li>
<li><p>获取json字符串</p>
</li>
<li><p>json.loads 执行反序列化</p>
</li>
<li><p>使用dict|list操作获取json data 中的数据value 值、</p>
</li>
</ol>
<h5 id="json-str-间接获取-获取动态页面数据请求返回的json-string"><a href="#json-str-间接获取-获取动态页面数据请求返回的json-string" class="headerlink" title="json_str 间接获取(获取动态页面数据请求返回的json string)"></a>json_str 间接获取(获取动态页面数据请求返回的json string)</h5><ol>
<li>导包</li>
<li>设置请求参数</li>
<li>设置url string</li>
<li>发送请求获取响应</li>
<li>获取响应中的内容数据</li>
<li>获取响应内容，解码为中文编码——decode(‘gb18030’)</li>
<li>反序列化为json data</li>
<li>获取数据</li>
</ol>
<h4 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 2-0. 声明变量</span></span><br><span class="line">name = <span class="string">&quot;hanmeimei&quot;</span></span><br><span class="line">age = <span class="number">22</span></span><br><span class="line">like = (<span class="string">&quot;reading&quot;</span>, <span class="string">&quot;somking&quot;</span>, <span class="string">&quot;sleeping&quot;</span>)</span><br><span class="line">chinee_score = <span class="number">10</span></span><br><span class="line">math_score = <span class="number">20</span></span><br><span class="line">english_score = <span class="number">30</span></span><br><span class="line">scores = &#123;<span class="string">&quot;chinese&quot;</span>: chinee_score, <span class="string">&quot;math&quot;</span>: math_score, <span class="string">&quot;english&quot;</span>: english_score&#125;</span><br><span class="line">student = &#123;<span class="string">&quot;name&quot;</span>: name, <span class="string">&quot;age&quot;</span>: age, <span class="string">&quot;like&quot;</span>: like, <span class="string">&quot;scores&quot;</span>: scores&#125;</span><br><span class="line"><span class="comment"># 2-1. 序列化为 string</span></span><br><span class="line">student_json_str = json.dumps(student)</span><br><span class="line"><span class="built_in">print</span>(student_json_str)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 2-2. 序列化为 file</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;student.json&#x27;</span>, <span class="string">&#x27;wt&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    json.dump(student, fp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;student.json&#x27;</span>, <span class="string">&#x27;rt&#x27;</span>) <span class="keyword">as</span> fp:</span><br><span class="line">    student_var = json.load(fp)</span><br><span class="line">student_var[<span class="string">&quot;name&quot;</span>] = <span class="string">&quot;lilei&quot;</span></span><br><span class="line"><span class="built_in">print</span>(student_var)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h3><h4 id="解析json"><a href="#解析json" class="headerlink" title="解析json"></a>解析json</h4><p>原生、GSon、Jackson、Fastjson</p>
<p>嵌套解析赋值:<strong>Fastjson</strong>(嵌套解析赋值)</p>
<h4 id="java-json-string-解析"><a href="#java-json-string-解析" class="headerlink" title="java json string 解析"></a>java json string 解析</h4><ol>
<li><p>java json string 变量</p>
</li>
<li><p>java json url jsonDataString</p>
<ul>
<li><p>反序列化</p>
<p>Entity entity JSON.parseObject(jsonString,Entity.class)</p>
<p>建议:</p>
<p>Entity(Field|nametype) 直接简单映射 json String (key,value)</p>
</li>
<li><p>序列化</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">JSON.toJSONString(student)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ol>
<h2 id="Python-Scrapy"><a href="#Python-Scrapy" class="headerlink" title="Python Scrapy"></a>Python Scrapy</h2><h3 id="引入"><a href="#引入" class="headerlink" title="引入"></a>引入</h3><p>单脚本爬虫 :request 发送/reponse 数据解析、定位、提取,自行代码实现</p>
<h4 id="爬虫框架"><a href="#爬虫框架" class="headerlink" title="爬虫框架"></a>爬虫框架</h4><ul>
<li>python爬虫框架 -Scrapy(twisted)    <strong>填空</strong></li>
</ul>
<h4 id="提问和思考"><a href="#提问和思考" class="headerlink" title="提问和思考"></a>提问和思考</h4><h5 id="爬虫的本质"><a href="#爬虫的本质" class="headerlink" title="爬虫的本质"></a>爬虫的本质</h5><ol>
<li>分析并且获取待爬取的url(s)</li>
<li>发送请求,解析,定位,提取</li>
<li>输出</li>
</ol>
<p><strong>总结三步</strong>:输入、处理、输出</p>
<p>输入:</p>
<ul>
<li>分析并且构造待爬取的url list</li>
</ul>
<p>处理</p>
<ul>
<li>封装请求(头参数、方法、数据)</li>
<li>发送请求(借助代理&lt;IP池、Account&gt;)</li>
<li>获取响应</li>
<li>分析响应数据(包含待爬去的数据)<ul>
<li>响应状态码</li>
<li>处理响应数据<ul>
<li>binary data、file</li>
<li>IOStream —— download</li>
<li>静态页面提取</li>
<li>解析(soup、etree)</li>
<li>定位要爬取的数据所在的元素(regex、css selector、xpath)</li>
<li>提取(标签内容的文本、标签属性值)</li>
<li>动态加载json数据,使用json解析完成提取</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>输出</p>
<ul>
<li><p>console Output</p>
</li>
<li><p>FS file (local、remote、DFS&lt; HDFS &gt;)</p>
<ul>
<li>IOStream(第三方模块)(txt、json、csv、xls)</li>
</ul>
</li>
<li><p>DB</p>
<ul>
<li>RDBMS :MySQL</li>
<li>NoSQL :MongoDB、HBase、Hive</li>
</ul>
</li>
</ul>
<h5 id="共性和个性"><a href="#共性和个性" class="headerlink" title="共性和个性"></a>共性和个性</h5><p>不变(共性):</p>
<ul>
<li>发送请求、获取响应、解析、输出目标(dest、filepath、driver、pip install)</li>
</ul>
<p>可变(个性):</p>
<ul>
<li>分析、获取url(s)、headers、method、data、proxy、定位和提取、输出(基础配置:type、dest、db(url、usn、pwd)、实际输出)</li>
</ul>
<h3 id="Scrapy-组件"><a href="#Scrapy-组件" class="headerlink" title="Scrapy 组件"></a>Scrapy 组件</h3><h4 id="settings"><a href="#settings" class="headerlink" title="settings"></a>settings</h4><h5 id="位置信息"><a href="#位置信息" class="headerlink" title="位置信息"></a>位置信息</h5><ul>
<li>scrapy.cfg </li>
</ul>
<h5 id="项目名"><a href="#项目名" class="headerlink" title="项目名"></a>项目名</h5><ul>
<li>settings.py</li>
</ul>
<h5 id="内容-1"><a href="#内容-1" class="headerlink" title="内容:"></a>内容:</h5><ul>
<li>指明 spider 代码的位置<ul>
<li>PIDER_MODULES = 项目名(包名).spiders</li>
<li>(?)指明是否需要遵守 robot.txt == 修改为 False   <figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROBOTSTXT_OBEY = False</span><br></pre></td></tr></table></figure>
<h5 id="关注"><a href="#关注" class="headerlink" title="关注:"></a>关注:</h5></li>
</ul>
</li>
<li><em>itempipelines</em><br> <code>ITEM_PIPELINES</code></li>
<li><em>请求参数</em><br> <code>user-agnet / request_headers </code></li>
<li><em>middlewares</em><br> <code>spider / downloader </code></li>
<li>item(s)<ul>
<li>items.py == 声明所有的爬取数据保存的数据项</li>
<li>借助 类(s) 声明要保存的数据项</li>
</ul>
</li>
<li>settings.py <ul>
<li>ITEM_PIPELINES</li>
</ul>
</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/23/%E7%AC%AC%E5%8D%81%E5%A4%A9/" data-id="ckscnkdr4000ksy5bbq3gegl6" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-第九天" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/21/%E7%AC%AC%E4%B9%9D%E5%A4%A9/" class="article-date">
  <time datetime="2021-07-21T01:05:58.000Z" itemprop="datePublished">2021-07-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/21/%E7%AC%AC%E4%B9%9D%E5%A4%A9/">“第九天”</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="回顾"><a href="#回顾" class="headerlink" title="回顾"></a>回顾</h2><h3 id="动态界面的判定和爬取"><a href="#动态界面的判定和爬取" class="headerlink" title="动态界面的判定和爬取"></a>动态界面的判定和爬取</h3><h4 id="判定"><a href="#判定" class="headerlink" title="判定"></a>判定</h4><p>比对 :html_text和浏览器中显示的数据</p>
<ul>
<li><p>一致:静态网页</p>
</li>
<li><p>不一致: 动态网页,浏览器显示的数据是由加载页面是向后端发送的ajax请求获取的</p>
</li>
</ul>
<h4 id="爬取"><a href="#爬取" class="headerlink" title="爬取"></a>爬取</h4><ol>
<li><p>分析获取一步加载的请求url,获取并解析其响应(Json),提取数据</p>
<p>分析获取:浏览器开发模式-&gt; 网络 -&gt;输入某个数据-&gt;完成查询-&gt;显示-&gt;定位请求-&gt;查看到url</p>
<p>适用海量、大型项目</p>
</li>
<li><p>使用html测试框架(selenium)模拟浏览器获取数据(任何类型的数据均显示在测试浏览器中),使用css selector | xpath完成,解析定位提取</p>
</li>
</ol>
<h2 id="Python-IO-python-file"><a href="#Python-IO-python-file" class="headerlink" title="Python IO == python file"></a>Python IO == python file</h2><h3 id="基础操作"><a href="#基础操作" class="headerlink" title="基础操作"></a>基础操作</h3><ul>
<li><p>获取文件的相关信息</p>
</li>
<li><p>文件读写(文本、二进制)</p>
</li>
</ul>
<p>with open(文件名,模式,encoding=’utf-8’) as fp:</p>
<p>​    fp….</p>
<h3 id="数据文件——特殊格式文件"><a href="#数据文件——特殊格式文件" class="headerlink" title="数据文件——特殊格式文件"></a>数据文件——特殊格式文件</h3><p>对象序列化</p>
<p>txt\</p>
<p>csv\json\xls(xlsx)</p>
<p>json &lt;——&gt; csv &lt;——&gt;xls</p>
<p><img src="https://i.niupic.com/images/2021/07/21/9ou5.png"></p>
<p>xml描述学生类</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">students</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">student</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span>&gt;</span>1<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">name</span>&gt;</span>zhangsan<span class="tag">&lt;/<span class="name">name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">age</span>&gt;</span>20<span class="tag">&lt;/<span class="name">age</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">student</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">students</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>JSon描述学生类(<strong>更多地作为数据承载容器</strong>)</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &#x27;id&#x27;:<span class="number">1</span>,</span><br><span class="line">  &#x27;name&#x27;:&#x27;zhangsan&#x27;</span><br><span class="line">  &#x27;age&#x27;: <span class="number">20</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Java-IO"><a href="#Java-IO" class="headerlink" title="Java IO"></a>Java IO</h2><p><img src="https://img-blog.csdnimg.cn/img_convert/8ddfe1e42b7cc02f7fb38b4a22570b7d.png" alt="请添加图片描述"></p>
<h3 id="bytestream-–-gt-charstream"><a href="#bytestream-–-gt-charstream" class="headerlink" title="bytestream –&gt;charstream"></a>bytestream –&gt;charstream</h3><h4 id="Input"><a href="#Input" class="headerlink" title="Input"></a>Input</h4><ol>
<li><p>声明字节输入流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">InputStream is =<span class="keyword">new</span> FileInputStreamReader(is)</span><br></pre></td></tr></table></figure></li>
<li><p>字节输入流桥接到字符流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">InputStreamReader isr=<span class="keyword">new</span> InputStreamReader(is)</span><br></pre></td></tr></table></figure></li>
<li><p>封装isr为字符流</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Reader reader =<span class="keyword">new</span> FileReader(isr);<span class="comment">//或者</span></span><br><span class="line">Reader fr=<span class="keyword">new</span> FileReader(file)</span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="Output"><a href="#Output" class="headerlink" title="Output"></a>Output</h4><p>output类似</p>
<h2 id="Java-Reflect"><a href="#Java-Reflect" class="headerlink" title="Java Reflect"></a>Java Reflect</h2><h3 id="解析类的内部信息"><a href="#解析类的内部信息" class="headerlink" title="解析类的内部信息"></a>解析类的内部信息</h3><h4 id="可以实现的功能"><a href="#可以实现的功能" class="headerlink" title="可以实现的功能"></a>可以实现的功能</h4><ol>
<li>获取|声明 找到一个类</li>
<li>解析类(获取类中的内容)</li>
<li>操作某个类(实例化、调用类中的方法、读|写属性)——甚至private</li>
</ol>
<h4 id="解析List-ArrayList-LinkedList"><a href="#解析List-ArrayList-LinkedList" class="headerlink" title="解析List(ArrayList,LinkedList)"></a>解析List(ArrayList,<em>LinkedList</em>)</h4><h5 id="JavaClass"><a href="#JavaClass" class="headerlink" title="JavaClass:"></a>JavaClass:</h5><ol>
<li><p>package</p>
</li>
<li><p>import —— 变通的方法</p>
</li>
</ol>
<h5 id="类声明"><a href="#类声明" class="headerlink" title="类声明"></a>类声明</h5><ol start="3">
<li><p>modifier</p>
</li>
<li><p>classname</p>
</li>
<li><p>generictype</p>
</li>
<li><p>superclass</p>
</li>
<li><p>inerface(s)</p>
</li>
</ol>
<h5 id="类内部"><a href="#类内部" class="headerlink" title="类内部"></a>类内部</h5><ol start="8">
<li>innerclass | outerclass</li>
<li>field(modifier、fieldname)</li>
<li>constructor(构造方法)(modifier、parameters type)</li>
<li>method(s)(modifier、name、parameeters type、throwsexception)</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/21/%E7%AC%AC%E4%B9%9D%E5%A4%A9/" data-id="ckscnkdq10008sy5b9cz21pqy" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%96%87%E4%BB%B6/" rel="tag">文件</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-第八天" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/20/%E7%AC%AC%E5%85%AB%E5%A4%A9/" class="article-date">
  <time datetime="2021-07-20T00:34:49.000Z" itemprop="datePublished">2021-07-20</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/20/%E7%AC%AC%E5%85%AB%E5%A4%A9/">第八篇博客</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="回顾lxml"><a href="#回顾lxml" class="headerlink" title="回顾lxml"></a>回顾lxml</h2><h3 id="要点"><a href="#要点" class="headerlink" title="要点"></a>要点</h3><h4 id="1-导入XPath解析器"><a href="#1-导入XPath解析器" class="headerlink" title="1. 导入XPath解析器"></a>1. 导入XPath解析器</h4><p><code>from lxml import tree</code></p>
<h4 id="2-将html-text解析为xpath文档"><a href="#2-将html-text解析为xpath文档" class="headerlink" title="2. 将html_text解析为xpath文档"></a>2. 将html_text解析为xpath文档</h4><p><code>selector = etree.HTML(html_text)</code></p>
<h4 id="3-一次性页面数据的定位和提取"><a href="#3-一次性页面数据的定位和提取" class="headerlink" title="3. 一次性页面数据的定位和提取"></a>3. 一次性页面数据的定位和提取</h4><h5 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h5><p>/ 从根目录开始寻找</p>
<ul>
<li><p>定位字符串首字符,从根目录开始查询定位</p>
</li>
<li><p>定位字符串的中间:上一个元素的直接(下一个)子元素</p>
</li>
</ul>
<p>// 相对定位</p>
<ul>
<li><p>定位字符串首字符,在整个文档中遍历查询定位</p>
</li>
<li><p>定位字符串的中间:上一个元素的间接子元素(后代中的某一个)</p>
</li>
</ul>
<p>/ or// 后续字符</p>
<ul>
<li><p>* 任意字符-任意标签名称元素</p>
</li>
<li><p>具体字符串——指定标签名称的元素</p>
</li>
</ul>
<p>[ ] 对于元素的限定的查询,对标签元素的查询条件</p>
<ul>
<li>@ 标签元素中属性值的提取,并根据属性值完成查询定位</li>
<li> text()  获取标签元素的文本值,并根据文本值的定位查询 </li>
<li>text()==‘str</li>
<li>[contains(text(),“str”)]</li>
</ul>
<p>tai 定位到某一个元素的下一个元素</p>
<h5 id="提取"><a href="#提取" class="headerlink" title="提取"></a>提取</h5><p>[@属性名] : 放在定位字符串的末端,提取定位标签的指定属性值</p>
<p>[text()] : 放在定位字符串的末端,提取定位标签体的文本值</p>
<p><strong>提取的返回值可能是list,可能需要指定list中的某一元素,一般是[0] (第一个元素)</strong></p>
<h3 id="python-spider"><a href="#python-spider" class="headerlink" title="python spider"></a>python spider</h3><p>随机选取某个user-agent</p>
<p>status_code == 418 : 没有加入request_headers参数</p>
<p>跨页爬取</p>
<h2 id="总结-爬虫代码的本质-amp-关键"><a href="#总结-爬虫代码的本质-amp-关键" class="headerlink" title="总结:爬虫代码的本质 &amp; 关键"></a>总结:爬虫代码的本质 &amp; 关键</h2><h3 id="1-分析并获取要爬取数据所在的url-关键"><a href="#1-分析并获取要爬取数据所在的url-关键" class="headerlink" title="1. 分析并获取要爬取数据所在的url(关键)"></a>1. 分析并获取要爬取数据所在的url(关键)</h3><p>uri(html页面、资源名称&lt;文件&gt;)</p>
<h3 id="2-封装请求"><a href="#2-封装请求" class="headerlink" title="2.封装请求"></a>2.封装请求</h3><p>需要封装:</p>
<p>​    请求参数、请求方法、请求数据、请求url</p>
<h3 id="3-发送请求-获取响应"><a href="#3-发送请求-获取响应" class="headerlink" title="3. 发送请求,获取响应"></a>3. 发送请求,获取响应</h3><p>获取响应头==获取状态码</p>
<p>将响应的内容转化为要处理的数据</p>
<h3 id="4-处理响应数据"><a href="#4-处理响应数据" class="headerlink" title="4. 处理响应数据"></a>4. 处理响应数据</h3><p>html_text : 使用解析、定位、提取</p>
<p>资源文件: 资源下载 ——IO</p>
<h2 id="Java-Splider"><a href="#Java-Splider" class="headerlink" title="Java Splider"></a>Java Splider</h2><h3 id="URL-资源环境"><a href="#URL-资源环境" class="headerlink" title="URL==资源环境"></a>URL==资源环境</h3><p>new maven project ==无骨架</p>
<h4 id="TestUrl"><a href="#TestUrl" class="headerlink" title="TestUrl"></a>TestUrl</h4><ol>
<li><p>声明待爬取页面的url字符串</p>
</li>
<li><p>创建基于URL字符串的URL对象</p>
</li>
<li><p>基于URL对象打开远程资源的InputStream</p>
</li>
<li><p>借助javaIO完成对资源的获取</p>
</li>
</ol>
<h4 id="GetIMDBVideo"><a href="#GetIMDBVideo" class="headerlink" title="GetIMDBVideo"></a>GetIMDBVideo</h4><ol>
<li>声明待爬取页面的url字符串</li>
<li>创建基于URL字符串的URL对象</li>
<li>基于URL对象的HttpURLConnection</li>
<li>(可选)基于HttpURLConnection完成请求封装</li>
<li>基于HttpURLConnection获取响应</li>
<li>基于HttpURLConnection获取输入流</li>
</ol>
<h3 id="JSoup-解析、定位、提取、下载html页面中的数据"><a href="#JSoup-解析、定位、提取、下载html页面中的数据" class="headerlink" title="JSoup==解析、定位、提取、下载html页面中的数据"></a>JSoup==解析、定位、提取、下载html页面中的数据</h3><h5 id="1-添加依赖"><a href="#1-添加依赖" class="headerlink" title="1. 添加依赖"></a>1. 添加依赖</h5><p>Baidu: mvn jsoup</p>
<p>加入</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.jsoup/jsoup --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.jsoup<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsoup<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.13.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h5 id="2-new-class"><a href="#2-new-class" class="headerlink" title="2. new class"></a>2. new class</h5><ol>
<li><p>分析并获取要爬取数据所在的页面的url</p>
</li>
<li><p>创建基于Jsoup的该url的connection</p>
</li>
<li><p>封装请求(头)参数</p>
</li>
<li><p>发送请求(指定请求方法),获取解析生成soup文档</p>
</li>
<li><p>基于soup文档中的元素执行定位(待爬取所在html标签元素)</p>
</li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/20/%E7%AC%AC%E5%85%AB%E5%A4%A9/" data-id="ckscnkdqb000dsy5bd2op8u5f" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Java/" rel="tag">Java</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-第七天" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2021/07/19/%E7%AC%AC%E4%B8%83%E5%A4%A9/" class="article-date">
  <time datetime="2021-07-19T00:44:55.000Z" itemprop="datePublished">2021-07-19</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2021/07/19/%E7%AC%AC%E4%B8%83%E5%A4%A9/">第七篇博客</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="http协议"><a href="#http协议" class="headerlink" title="http协议"></a>http协议</h2><h3 id="http请求过程如下"><a href="#http请求过程如下" class="headerlink" title="http请求过程如下"></a>http请求过程如下</h3><ul>
<li><p>由HTTP客户端向服务器发起一个请求，创建一个到服务器指定端口（默认是80端口）的TCP连接。</p>
</li>
<li><p>HTTP服务器从该端口监听客户端的请求。</p>
</li>
<li><p>一旦收到请求，服务器会向客户端返回一个状态，比如“HTTP/1.1 200 OK”，以及返回的响应内容，如请求的文件、错误消息、或其它信息。</p>
</li>
</ul>
<h3 id="爬虫的请求方法"><a href="#爬虫的请求方法" class="headerlink" title="爬虫的请求方法"></a>爬虫的请求方法</h3><table>
<thead>
<tr>
<th align="center"><strong>请求方法</strong></th>
<th align="center"><strong>方法描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>GET</strong></td>
<td align="center">请求指定的页面信息，并返回实体主体。GET可能会被网络爬虫等随意访问，因此GET方法应该只用在读取数据，而不应当被用于产生“副作用”的操作中，例如在Web Application中</td>
</tr>
<tr>
<td align="center"><strong>HEAD</strong></td>
<td align="center">与GET方法一样，都是向服务器发出指定资源的请求。只不过服务器将不传回具体的内容，使用这个方法可以在不必传输全部内容的情况下，就可以获取其中该资源的相关信息（元信息或称元数据）</td>
</tr>
<tr>
<td align="center"><strong>POST</strong></td>
<td align="center">向指定资源提交数据，请求服务器进行处理（例如提交表单或者上传文件）。数据会被包含在请求中，这个请求可能会创建新的资源或修改现有资源，或二者皆有</td>
</tr>
<tr>
<td align="center"><strong>PUT</strong></td>
<td align="center">从客户端上传指定资源的最新内容，即更新服务器端的指定资源。</td>
</tr>
</tbody></table>
<h3 id="客户端与服务器间的请求与响应的具体步骤如下"><a href="#客户端与服务器间的请求与响应的具体步骤如下" class="headerlink" title="客户端与服务器间的请求与响应的具体步骤如下"></a>客户端与服务器间的请求与响应的具体步骤如下</h3><ul>
<li><p>连接Web服务器：由一个HTTP客户端发起连接，与Web服务器的HTTP端口（默认为80）建立一个TCP套接字连接。</p>
</li>
<li><p>发送HTTP请求：客户端经TCP套接字向Web服务器发送一个文本的请求报文。</p>
</li>
<li><p>服务器接受请求并返回HTTP响应：Web服务器解析请求，定位该次的请求资源。之后将资源复本写至TCP套接字，由客户端进行读取。</p>
</li>
<li><p>释放连接TCP连接：若连接的connection模式为close，则由服务器主动关闭TCP连接，客户端将被动关闭连接，释放TCP连接；若connection模式为keepalive，则该连接会保持一段时间。</p>
</li>
<li><p>客户端解析HTML内容：客户端首先会对状态行进行解析，之后解析每一个响应头，最后读取响应数据。</p>
</li>
</ul>
<h3 id="http状态码种类"><a href="#http状态码种类" class="headerlink" title="http状态码种类"></a>http状态码种类</h3><table>
<thead>
<tr>
<th align="center"><strong>常见状态码</strong></th>
<th align="center"><strong>状态码含义</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>200 OK</strong></td>
<td align="center">请求成功，请求所希望的响应头或数据体将随此响应返回。</td>
</tr>
<tr>
<td align="center"><strong>400 Bad Request</strong></td>
<td align="center">由于客户端的语法错误、无效的请求或欺骗性路由请求，服务器不会处理该请求。</td>
</tr>
<tr>
<td align="center"><strong>403 Forbidden</strong></td>
<td align="center">服务器已经理解该请求，但是拒绝执行，将在返回的实体内描述拒绝的原因，也可以不描述仅返回404响应。</td>
</tr>
<tr>
<td align="center"><strong>404 Not Found</strong></td>
<td align="center">请求失败，请求所希望得到的资源未被在服务器上发现，但允许用户的后续请求。</td>
</tr>
<tr>
<td align="center"><strong>500 Internal Server Error</strong></td>
<td align="center">通用错误消息，服务器遇到了一个未曾预料的状况，导致了它无法完成对请求的处理，不会给出具体错误信息。</td>
</tr>
<tr>
<td align="center"><strong>503 Service Unavailable</strong></td>
<td align="center">由于临时的服务器维护或者过载，服务器当前无法处理请求。这个状况是暂时的，并且将在一段时间以后恢复。</td>
</tr>
</tbody></table>
<p><strong>DDos攻击</strong>——服务器处理垃圾请求,没有时间响应用户的请求</p>
<h3 id="所有的User-agent"><a href="#所有的User-agent" class="headerlink" title="所有的User-agent"></a>所有的User-agent</h3><p><a target="_blank" rel="noopener" href="https://developers.whatismybrowser.com/">网站1</a></p>
<p><a target="_blank" rel="noopener" href="https://developers.whatismybrowser.com/useragents/explore/">网站2</a></p>
<h3 id="HTTP头部信息"><a href="#HTTP头部信息" class="headerlink" title="HTTP头部信息"></a>HTTP头部信息</h3><table>
<thead>
<tr>
<th align="center"><strong>字段名</strong></th>
<th align="center"><strong>说明</strong></th>
<th align="center"><strong>示例</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>Accept</strong></td>
<td align="center">可接受的响应内容类型（Content-Types）</td>
<td align="center">Accept: text/plain</td>
</tr>
<tr>
<td align="center"><strong>Accept-Charset</strong></td>
<td align="center">可接受的字符集</td>
<td align="center">Accept-Charset:utf-8</td>
</tr>
<tr>
<td align="center"><strong>Accept-Encoding</strong></td>
<td align="center">可接受的响应内容的编码方式</td>
<td align="center">Accept-Encoding:gzip,deflate</td>
</tr>
<tr>
<td align="center"><strong>Accept-Language</strong></td>
<td align="center">可接受的响应内容语言列表</td>
<td align="center">Accept-Language:en-US</td>
</tr>
<tr>
<td align="center"><strong>Cookie</strong></td>
<td align="center">由之前服务器通过Set-Cookie设置的一个HTTP协议Cookie</td>
<td align="center">Cookie:$Version=1;Skin=new;</td>
</tr>
<tr>
<td align="center"><strong>Referer</strong></td>
<td align="center">设置前一个页面的地址，并且前一个页面中的连接指向当前请求，意思就是如果当前请求是在A页面中发送的，那么referer就是A页面的url地址</td>
<td align="center">Referer:<a target="_blank" rel="noopener" href="http://zh.wikipedia.org/wiki/Main_Page">http://zh.wikipedia.org/wiki/Main_Page</a></td>
</tr>
<tr>
<td align="center"><strong>User-Agent</strong></td>
<td align="center">用户代理的字符串值</td>
<td align="center">User-Agent:Mozilla/5.0(X11;Linuxx86_64;rv:12.0)Gecko/20100101Firefox/21.0</td>
</tr>
</tbody></table>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><ul>
<li><p>对超文本传输协议（HTTP）及其相关机制进行了简要介绍。</p>
</li>
<li><p>HTTP协议基于TCP协议进行客户端与服务器间的通讯，由客户端发起请求，服务器进行应答。</p>
</li>
<li><p>HTTP状态码由3位数字构成，按首位数字可分为5类状态码。</p>
</li>
<li><p>HTTP头部信息为HTTP协议的请求与响应消息中的消息头部分，其定义了该次传输事务中的操作参数。</p>
</li>
<li><p>Cookie机制可记录用户状态，</p>
</li>
<li><p>服务器可依据Cookie对用户状态进行记录与识别。</p>
</li>
</ul>
<h2 id="CSS选择器"><a href="#CSS选择器" class="headerlink" title="CSS选择器"></a>CSS选择器</h2><h3 id="元素选择器"><a href="#元素选择器" class="headerlink" title="元素选择器"></a>元素选择器</h3><p>HTML文档中该选择器通常指某种HTML元素<br>使用元素选择器的方法为直接使用元素的标签名称(tag name)</p>
<h3 id="ID选择器"><a href="#ID选择器" class="headerlink" title="ID选择器"></a>ID选择器</h3><p>ID选择器类似类选择器</p>
<ul>
<li><p>一个元素只能拥有一个唯一的ID属性</p>
</li>
<li><p>一个元素不能像类属性一样拥有多个类</p>
</li>
<li><p>一个ID 值在一个HTML文档中只能出现一次</p>
</li>
<li><p>一个ID只能唯一标识一个元素(不是一类元素，而是一个元素)</p>
</li>
<li><p>使用ID选择器的方法为井号”#”后面跟id值</p>
</li>
</ul>
<h3 id="属性选择器"><a href="#属性选择器" class="headerlink" title="属性选择器"></a>属性选择器</h3><p>  属性选择器可以根据元素的属性及属性值来选择元素。<br>  包括：简单属性选择器、具体属性值选择器、部分属性值选择器。<br>  组合使用类选择器使选择更灵活</p>
<h3 id="类选择器"><a href="#类选择器" class="headerlink" title="类选择器"></a>类选择器</h3><p>  类选择器允许以一种独立于文档元素的方式来指定样式。</p>
<h3 id="派生选择器"><a href="#派生选择器" class="headerlink" title="派生选择器"></a>派生选择器</h3><p>  又名上下文选择器，使用文档DOM结构来进行选择。<br>  包含：后代选择器(descendant selector)、子元素选择器(child selector)、相邻兄弟选择器(Adjacent sibling selector)。</p>
<h2 id="Spider-tools-爬虫实现层次"><a href="#Spider-tools-爬虫实现层次" class="headerlink" title="Spider tools(爬虫实现层次)"></a>Spider tools(爬虫实现层次)</h2><h3 id="本质-借助URL完成IO"><a href="#本质-借助URL完成IO" class="headerlink" title="本质: 借助URL完成IO"></a>本质: 借助URL完成IO</h3><p>​    Python: urllib、urllib3</p>
<p>​    Java: Jav.net.URL</p>
<h3 id="借助封装的第三方模块"><a href="#借助封装的第三方模块" class="headerlink" title="借助封装的第三方模块"></a>借助封装的第三方模块</h3><p>​    Python: request、BueatifulSoup4(借助css的选择器)、lxm(Xpath)</p>
<p>​    Java; JSoup</p>
<h3 id="借助爬虫框架"><a href="#借助爬虫框架" class="headerlink" title="借助爬虫框架"></a>借助爬虫框架</h3><p>​    Python: Scrapy</p>
<p>​    Java:WebMagic</p>
<h3 id="借助html测试框架"><a href="#借助html测试框架" class="headerlink" title="借助html测试框架"></a>借助html测试框架</h3><p>​    Python :selenium</p>
<p>​    Java :selenium、pyteer、httpclient、htmlclirnt</p>
<h2 id="python-amp-Java-静态页面的获取"><a href="#python-amp-Java-静态页面的获取" class="headerlink" title="python &amp; Java(静态页面的获取)"></a>python &amp; Java(静态页面的获取)</h2><h3 id="手工从浏览器显示的页面中获取数据"><a href="#手工从浏览器显示的页面中获取数据" class="headerlink" title="手工从浏览器显示的页面中获取数据"></a>手工从浏览器显示的页面中获取数据</h3><ol>
<li><p>打开浏览器</p>
</li>
<li><p>输入地址——url|uri</p>
</li>
<li><p>回车——发送get请求</p>
</li>
<li><p>获取请求的响应——reponse</p>
<ul>
<li><p>reponse text ——html</p>
<ul>
<li>页面的源代码</li>
</ul>
</li>
</ul>
</li>
<li><p>将html文本渲染显示在浏览器窗口中,对于静态数据和动态数据的渲染</p>
</li>
<li><p>解析-定位-提取</p>
</li>
</ol>
<h3 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h3><h4 id="urilib-amp-urllib3"><a href="#urilib-amp-urllib3" class="headerlink" title="urilib &amp; urllib3"></a>urilib &amp; urllib3</h4><h5 id="urllib"><a href="#urllib" class="headerlink" title="urllib"></a>urllib</h5><p><a target="_blank" rel="noopener" href="https://docs.python.org/zh-cn/3/library/urllib.html">官方地址</a></p>
<ul>
<li><p> Url: 获取资源文件</p>
</li>
<li><p> 生成url、发送请求、获取请求的响应、处理响应</p>
</li>
<li><p>urllib的定位</p>
<ul>
<li>获取网上的资源文件(下载img/video)  </li>
</ul>
</li>
</ul>
<h4 id="requests-beatifulsoup4-lxml"><a href="#requests-beatifulsoup4-lxml" class="headerlink" title="requests, beatifulsoup4 , lxml"></a>requests, beatifulsoup4 , lxml</h4><p><a target="_blank" rel="noopener" href="https://docs.python-requests.org/zh_CN/latest/">requests网址</a></p>
<p><a target="_blank" rel="noopener" href="https://www.crummy.com/software/BeautifulSoup/bs4/doc.zh/">beatifulsoup4</a></p>
<p><a target="_blank" rel="noopener" href="https://lxml.de/">lxml网站</a></p>
<h5 id="requests——发送请求-获取响应-html文本"><a href="#requests——发送请求-获取响应-html文本" class="headerlink" title="requests——发送请求,获取响应(html文本)"></a>requests——发送请求,获取响应(html文本)</h5><p>反反爬机制</p>
<ul>
<li>request_headers(user-agent,…..)</li>
<li>发送请求+ip代理(ip池…基于sockers的ip代理池)</li>
<li>账户池、accountpool</li>
<li>发送线程的休眠 Thread.sleep(…ms)</li>
<li>requests+cookies</li>
</ul>
<p>获取百度页面的html的源代码</p>
<ul>
<li>给出request headers</li>
<li>给出url</li>
<li>发送请求(给出请求方式、请求参数),获得响应,得到相应的text</li>
<li>html_text处理</li>
</ul>
<h5 id="beatifulsoup4-使用css选择器完成对页面源代码解析、定位、提取"><a href="#beatifulsoup4-使用css选择器完成对页面源代码解析、定位、提取" class="headerlink" title="beatifulsoup4 使用css选择器完成对页面源代码解析、定位、提取"></a>beatifulsoup4 使用css选择器完成对页面源代码解析、定位、提取</h5><p>获取豆瓣影评的所需信息(作者 &amp; 电影)</p>
<p>获取酷狗Top250歌曲的信息</p>
<ul>
<li><p>有main方法和抓取python方法的实现</p>
<ul>
<li><p>序号</p>
</li>
<li><p>歌手 &amp; 歌名</p>
<p><code>ranWrap(id值) &gt; div.pc_temp_songlist &gt; ul &gt; li:nth-child(2) &gt; a</code></p>
<p><code>div.pc_temp_songlist &gt; ul &gt; li &gt; a</code></p>
</li>
<li><p>播放时间</p>
<p><code>div.pc_temp_songlist &gt; ul &gt; li &gt; span.pc_temp_tips_r &gt; span</code></p>
<p>或者  <code>span.pc_temp_tips_r &gt; span</code></p>
</li>
</ul>
</li>
</ul>
<h6 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h6><ol>
<li>分析url &amp; 解析页面结构</li>
<li>生成request_headers</li>
<li>生成url_str</li>
<li>借助requests发请求,获取响应的html文本</li>
<li>使用bs4解析页面源码为soup文档</li>
<li>使用<strong>元素选择器或者css的类选择器</strong>进行定位(待爬取数据所在的html标签原色)</li>
<li>进行提取(提取是html文本:get_text().strip(),提取标签属性值:get(“标签属性名”))</li>
<li>处理提取的结果</li>
</ol>
<h6 id="Python-1"><a href="#Python-1" class="headerlink" title="Python"></a>Python</h6><p>main、def method、zip、{key:value}</p>
<h4 id="lxml的使用XPath"><a href="#lxml的使用XPath" class="headerlink" title="lxml的使用XPath"></a>lxml的使用XPath</h4><p>获取豆瓣图书top250图书主页的信息</p>
<p><code>content &gt; div &gt; div.article &gt; div &gt; table:nth-child(2) &gt; tbody &gt; tr &gt; td:nth-child(2) &gt; div.pl2 &gt; a</code></p>
<p><code>content &gt; div &gt; div.article &gt; div &gt; table:nth-child(2) &gt; tbody &gt; tr &gt; td:nth-child(1) &gt; a</code></p>
<p><strong>bs4中css选择器不支持nth-child属性</strong></p>
<p>选用<strong>div.pl2 &gt; a</strong></p>
<table>
<thead>
<tr>
<th align="center"><strong>表达式</strong></th>
<th align="center"><strong>描述</strong></th>
</tr>
</thead>
<tbody><tr>
<td align="center"><strong>nodename</strong></td>
<td align="center">选取此节点的所有子节点</td>
</tr>
<tr>
<td align="center"><strong>/</strong></td>
<td align="center">从根节点选取</td>
</tr>
<tr>
<td align="center"><strong>//</strong></td>
<td align="center">从匹配选择的当前节点选择文档中的节点，而不考虑它们的位置</td>
</tr>
<tr>
<td align="center"><strong>.</strong></td>
<td align="center">选取当前节点</td>
</tr>
<tr>
<td align="center"><strong>..</strong></td>
<td align="center">选取当前节点的父节点</td>
</tr>
<tr>
<td align="center"><strong>@</strong></td>
<td align="center">选取属性</td>
</tr>
</tbody></table>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/07/19/%E7%AC%AC%E4%B8%83%E5%A4%A9/" data-id="ckscnkdpx0005sy5b4ix1h8kb" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/http/" rel="tag">http</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a></li></ul>

    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/">下一页 &amp;raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签</h3>
    <div class="widget">
      <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Docker/" rel="tag">Docker</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/" rel="tag">Hadoop</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java/" rel="tag">Java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/" rel="tag">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hdfs/" rel="tag">hdfs</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/" rel="tag">http</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%AE%89%E8%A3%85/" rel="tag">安装</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%96%87%E4%BB%B6/" rel="tag">文件</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" rel="tag">浏览器</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%88%AC%E8%99%AB/" rel="tag">爬虫</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" rel="tag">虚拟机</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90/" rel="tag">项目分析</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">标签云</h3>
    <div class="widget tagcloud">
      <a href="/tags/Docker/" style="font-size: 10px;">Docker</a> <a href="/tags/Hadoop/" style="font-size: 10px;">Hadoop</a> <a href="/tags/Java/" style="font-size: 10px;">Java</a> <a href="/tags/Linux/" style="font-size: 15px;">Linux</a> <a href="/tags/hdfs/" style="font-size: 10px;">hdfs</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/%E5%AE%89%E8%A3%85/" style="font-size: 15px;">安装</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 15px;">数据库</a> <a href="/tags/%E6%96%87%E4%BB%B6/" style="font-size: 10px;">文件</a> <a href="/tags/%E6%B5%8F%E8%A7%88%E5%99%A8/" style="font-size: 15px;">浏览器</a> <a href="/tags/%E7%88%AC%E8%99%AB/" style="font-size: 20px;">爬虫</a> <a href="/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/" style="font-size: 15px;">虚拟机</a> <a href="/tags/%E9%A1%B9%E7%9B%AE%E5%88%86%E6%9E%90/" style="font-size: 10px;">项目分析</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/07/">七月 2021</a><span class="archive-list-count">16</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/07/31/hdfs/">hdfs</a>
          </li>
        
          <li>
            <a href="/2021/07/29/Hadoop/">Hadoop</a>
          </li>
        
          <li>
            <a href="/2021/07/28/%E8%99%9A%E6%8B%9F%E6%9C%BA2/">虚拟机2</a>
          </li>
        
          <li>
            <a href="/2021/07/27/Docker-in-Linux/">Docker in Linux</a>
          </li>
        
          <li>
            <a href="/2021/07/26/%E8%99%9A%E6%8B%9F%E6%9C%BA/">虚拟机</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2021 MainJay<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>